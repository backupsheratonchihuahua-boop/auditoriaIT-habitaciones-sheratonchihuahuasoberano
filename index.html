<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Auditoría Sistemas">
    <meta name="description" content="Sistema de auditoría de sistemas para Hotel Sheraton Chihuahua Soberano">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>Auditoría de Sistemas - Hotel Sheraton Chihuahua Soberano</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2235;
            --bg-input: #0d1424;
            --accent-primary: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --accent-info: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-gold: #eab308;
            --accent-pink: #ec4899;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-color: #2d3a50;
            --border-focus: #10b981;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.5);
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Login Screen Styles */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .login-overlay.hidden { display: none; }
        
        .login-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: var(--shadow-lg);
        }
        .login-logo {
            text-align: center;
            margin-bottom: 30px;
        }
        .login-logo .logo-icon {
            margin-bottom: 15px;
            background: none;
            width: auto;
            height: auto;
        }
        .login-logo .logo-icon img {
            max-width: 180px;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        .login-logo h1 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 5px;
            margin-top: 10px;
        }
        .login-logo p {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        .login-form { display: flex; flex-direction: column; gap: 16px; }
        .login-field { display: flex; flex-direction: column; gap: 6px; }
        .login-field label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 600;
        }
        .login-field input {
            padding: 12px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        .login-field input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }
        .login-btn {
            padding: 14px;
            background: var(--accent-primary);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            margin-top: 10px;
        }
        .login-btn:hover { background: #0ea371; }
        .login-btn:active { transform: scale(0.98); }
        .login-btn:disabled {
            background: var(--text-muted);
            cursor: not-allowed;
        }
        .login-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--accent-danger);
            border-radius: var(--radius-sm);
            padding: 12px;
            color: var(--accent-danger);
            font-size: 0.85rem;
            text-align: center;
            display: none;
        }
        .login-error.show { display: block; }
        
        /* User badge in header */
        .user-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 14px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
        }
        .user-badge .user-icon {
            width: 32px;
            height: 32px;
            background: var(--accent-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
        }
        .user-badge.admin .user-icon { background: var(--accent-purple); }
        .user-badge.advanced .user-icon { background: var(--accent-info); }
        .user-badge .user-info { display: flex; flex-direction: column; }
        .user-badge .user-name { font-weight: 600; font-size: 0.9rem; }
        .user-badge .user-role { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; }
        .logout-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid var(--accent-danger);
            border-radius: var(--radius-sm);
            color: var(--accent-danger);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .logout-btn:hover {
            background: var(--accent-danger);
            color: white;
        }
        
        /* Hide elements based on permission */
        .permission-hidden { display: none !important; }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }

        /* Connection Status */
        .connection-bar {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 12px 20px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.connected { background: var(--accent-primary); }
        .status-dot.disconnected { background: var(--accent-danger); }
        .status-dot.syncing { background: var(--accent-warning); }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .connection-info {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .connection-info strong {
            color: var(--text-primary);
        }

        .sync-btn {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 8px 16px;
            font-family: inherit;
            font-size: 0.85rem;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .sync-btn:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .sync-btn.syncing {
            pointer-events: none;
            opacity: 0.7;
        }

        .sync-btn.syncing .sync-icon {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Config Panel */
        .config-panel {
            background: linear-gradient(135deg, var(--accent-danger), #dc2626);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
            display: none;
        }

        .config-panel.show { display: block; }

        .config-panel h3 {
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .config-panel input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: var(--radius-sm);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            margin-bottom: 12px;
        }

        .config-panel button {
            background: white;
            color: var(--accent-danger);
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
        }

        /* Main Tabs */
        .main-tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-card);
            padding: 6px;
            border-radius: var(--radius-md);
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
        }

        .main-tab {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .main-tab:hover { background: var(--bg-input); color: var(--text-primary); }
        .main-tab.active { background: linear-gradient(135deg, var(--accent-primary), #059669); color: white; }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-lg);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 20px;
        }

        .logo-section { display: flex; align-items: center; gap: 16px; }

        .hotel-logo {
            height: 70px;
            width: auto;
            object-fit: contain;
        }

        .hotel-logo-print {
            display: none;
        }

        .logo-icon {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--accent-primary), #059669);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .title-group h1 { font-size: 1.5rem; font-weight: 700; letter-spacing: -0.5px; }
        .title-group p { font-size: 0.875rem; color: var(--text-secondary); font-family: 'JetBrains Mono', monospace; }

        .cloud-badge {
            background: linear-gradient(135deg, var(--accent-info), #2563eb);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .date-display {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 10px 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: var(--accent-primary);
        }

        .header-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
        }

        .input-group { display: flex; flex-direction: column; gap: 6px; }
        .input-group label { font-size: 0.75rem; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; }
        .input-group input, .input-group select {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 10px 14px;
            font-family: inherit;
            font-size: 0.9rem;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.15);
        }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 14px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .summary-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .summary-card.success { border-left: 3px solid var(--accent-primary); }
        .summary-card.warning { border-left: 3px solid var(--accent-warning); }
        .summary-card.danger { border-left: 3px solid var(--accent-danger); }
        .summary-card.info { border-left: 3px solid var(--accent-info); }
        .summary-card.purple { border-left: 3px solid var(--accent-purple); }

        .summary-value { font-family: 'JetBrains Mono', monospace; font-size: 1.6rem; font-weight: 700; margin-bottom: 4px; }
        .summary-card.success .summary-value { color: var(--accent-primary); }
        .summary-card.warning .summary-value { color: var(--accent-warning); }
        .summary-card.danger .summary-value { color: var(--accent-danger); }
        .summary-card.info .summary-value { color: var(--accent-info); }
        .summary-card.purple .summary-value { color: var(--accent-purple); }
        .summary-label { font-size: 0.65rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; }

        /* Room Navigation */
        .room-nav {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 24px;
        }

        .room-nav-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 16px;
        }

        .room-selector { display: flex; align-items: center; gap: 12px; }
        .room-selector label { font-weight: 600; color: var(--text-secondary); }

        .room-input {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 10px 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            width: 100px;
            text-align: center;
        }

        .room-type-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .room-type-badge.sencilla { background: rgba(59, 130, 246, 0.2); color: var(--accent-info); border: 1px solid var(--accent-info); }
        .room-type-badge.doble { background: rgba(139, 92, 246, 0.2); color: var(--accent-purple); border: 1px solid var(--accent-purple); }
        .room-type-badge.suite {
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.3), rgba(219, 39, 119, 0.2));
            color: var(--accent-pink);
            border: 1px solid var(--accent-pink);
        }
        .room-type-badge.presidencial {
            background: linear-gradient(135deg, rgba(234, 179, 8, 0.3), rgba(245, 158, 11, 0.2));
            color: var(--accent-gold);
            border: 1px solid var(--accent-gold);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0%, 100% { box-shadow: 0 0 5px rgba(234, 179, 8, 0.3); }
            50% { box-shadow: 0 0 15px rgba(234, 179, 8, 0.5); }
        }

        .nav-buttons { display: flex; gap: 8px; flex-wrap: wrap; }

        .btn {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 10px 16px;
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn:hover { background: var(--bg-secondary); border-color: var(--text-muted); }
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), #059669); border-color: var(--accent-primary); color: white; }
        .btn-primary:hover { background: linear-gradient(135deg, #059669, #047857); transform: translateY(-1px); }
        .btn-danger { border-color: var(--accent-danger); color: var(--accent-danger); }
        .btn-danger:hover { background: var(--accent-danger); color: white; }
        .btn-info { border-color: var(--accent-info); color: var(--accent-info); }
        .btn-info:hover { background: var(--accent-info); color: white; }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Room Grid */
        .room-grid-section { margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-color); }
        .floor-tabs { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }

        .floor-tab {
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .floor-tab:hover { border-color: var(--text-muted); }
        .floor-tab.active { background: var(--accent-primary); border-color: var(--accent-primary); color: white; }
        
        .floor-pending {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 20px;
            height: 20px;
            padding: 0 6px;
            margin-left: 6px;
            background: var(--accent-danger);
            color: white;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 700;
        }
        .floor-tab.active .floor-pending {
            background: rgba(255,255,255,0.3);
        }
        .floor-pending.complete {
            background: var(--accent-primary);
        }
        .floor-tab.active .floor-pending.complete {
            background: rgba(255,255,255,0.3);
        }

        .room-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(52px, 1fr)); gap: 6px; }

        .room-btn {
            padding: 8px 4px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-input);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            text-align: center;
        }

        .room-btn:hover { border-color: var(--text-muted); transform: scale(1.05); }
        .room-btn.sencilla { border-left: 2px solid var(--accent-info); }
        .room-btn.doble { border-left: 2px solid var(--accent-purple); }
        .room-btn.suite { border-left: 2px solid var(--accent-pink); background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), transparent); }
        .room-btn.presidencial { border-left: 2px solid var(--accent-gold); background: linear-gradient(135deg, rgba(234, 179, 8, 0.1), transparent); }
        .room-btn.audited { background: rgba(16, 185, 129, 0.15); border-color: var(--accent-primary); color: var(--accent-primary); }
        .room-btn.has-issues { background: rgba(239, 68, 68, 0.15); border-color: var(--accent-danger); color: var(--accent-danger); }
        .room-btn.current { background: var(--accent-info); border-color: var(--accent-info); color: white; transform: scale(1.1); }

        /* Audit Sections */
        .audit-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .section-header {
            background: var(--bg-secondary);
            padding: 14px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.2s;
        }

        .section-header:hover { background: var(--bg-input); }

        .section-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .section-icon.tv { background: linear-gradient(135deg, #6366f1, #4f46e5); }
        .section-icon.phone { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .section-icon.network { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .section-icon.router { background: linear-gradient(135deg, #10b981, #059669); }

        .section-title { flex: 1; font-weight: 600; font-size: 1rem; }

        .section-status {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            padding: 4px 10px;
            border-radius: 20px;
            background: var(--bg-input);
        }

        .section-status.complete { background: rgba(16, 185, 129, 0.2); color: var(--accent-primary); }
        .section-status.incomplete { background: rgba(245, 158, 11, 0.2); color: var(--accent-warning); }
        .section-status.error { background: rgba(239, 68, 68, 0.2); color: var(--accent-danger); }

        .section-content { padding: 20px; }

        /* Check Items */
        .check-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 12px; }

        .check-item {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
        }

        .check-item:hover { border-color: var(--text-muted); }
        .check-item.checked { border-color: var(--accent-primary); background: rgba(16, 185, 129, 0.05); }
        .check-item.failed { border-color: var(--accent-danger); background: rgba(239, 68, 68, 0.05); }
        .check-item.na { border-color: var(--text-muted); background: rgba(100, 116, 139, 0.1); opacity: 0.7; }

        .check-label { flex: 1; font-size: 0.85rem; }
        .check-label small { display: block; color: var(--text-muted); font-size: 0.7rem; margin-top: 2px; }

        .toggle-group { display: flex; gap: 4px; }

        .toggle-btn {
            padding: 4px 8px;
            font-size: 0.7rem;
            font-weight: 600;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-muted);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .toggle-btn.ok.active { background: var(--accent-primary); border-color: var(--accent-primary); color: white; }
        .toggle-btn.fail.active { background: var(--accent-danger); border-color: var(--accent-danger); color: white; }
        .toggle-btn.na.active { background: var(--text-muted); border-color: var(--text-muted); color: white; }

        /* Cobertura WiFi buttons */
        .coverage-group { flex-wrap: wrap; gap: 6px; }
        .toggle-btn.coverage-low { border-color: #ef4444; color: #ef4444; }
        .toggle-btn.coverage-low.active { background: #ef4444; border-color: #ef4444; color: white; }
        .toggle-btn.coverage-med { border-color: #f59e0b; color: #f59e0b; }
        .toggle-btn.coverage-med.active { background: #f59e0b; border-color: #f59e0b; color: white; }
        .toggle-btn.coverage-high { border-color: #22c55e; color: #22c55e; }
        .toggle-btn.coverage-high.active { background: #22c55e; border-color: #22c55e; color: white; }

        /* TV Specs Styles */
        .tv-specs-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg-input);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
        }
        .tv-spec-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .tv-spec-item.checked {
            position: relative;
        }
        .tv-spec-item.checked::after {
            content: '✓';
            position: absolute;
            top: 0;
            right: 0;
            color: var(--accent-primary);
            font-size: 0.8rem;
            font-weight: bold;
        }
        .tv-spec-item.checked .tv-spec-select {
            border-color: var(--accent-primary);
        }
        .tv-spec-item label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            font-weight: 600;
        }
        .tv-spec-select {
            padding: 8px 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.85rem;
        }
        .tv-spec-select:focus {
            outline: none;
            border-color: var(--accent-primary);
        }
        .hd-toggle {
            display: flex;
            gap: 6px;
        }
        .toggle-btn.hd-yes {
            border-color: #22c55e;
            color: #22c55e;
        }
        .toggle-btn.hd-yes.active {
            background: #22c55e;
            border-color: #22c55e;
            color: white;
        }
        .toggle-btn.hd-no {
            border-color: #ef4444;
            color: #ef4444;
        }
        .toggle-btn.hd-no.active {
            background: #ef4444;
            border-color: #ef4444;
            color: white;
        }

        /* Panasonic phone buttons */
        .panasonic-toggle {
            display: flex;
            gap: 6px;
        }
        .toggle-btn.panasonic-yes {
            border-color: #f59e0b;
            color: #f59e0b;
        }
        .toggle-btn.panasonic-yes.active {
            background: #f59e0b;
            border-color: #f59e0b;
            color: white;
        }
        .toggle-btn.panasonic-no {
            border-color: #22c55e;
            color: #22c55e;
        }
        .toggle-btn.panasonic-no.active {
            background: #22c55e;
            border-color: #22c55e;
            color: white;
        }

        /* Channel Grid */
        .channel-info {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 10px 14px;
            margin-bottom: 12px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .channel-info strong { color: var(--accent-info); }

        .channel-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(85px, 1fr)); gap: 6px; }

        .channel-btn {
            aspect-ratio: auto;
            min-height: 50px;
            padding: 4px 6px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-input);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            text-align: center;
        }

        .channel-btn .ch-num {
            font-weight: 700;
            font-size: 0.9rem;
            color: var(--text-primary);
        }
        .channel-btn .ch-name {
            font-size: 0.55rem;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        .channel-btn .hd-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.45rem;
            background: var(--accent-info);
            color: white;
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: 700;
        }
        .channel-btn.hd-channel {
            border-color: var(--accent-info);
        }

        .channel-btn:hover { border-color: var(--text-muted); transform: scale(1.05); }
        .channel-btn.checked { background: var(--accent-primary); border-color: var(--accent-primary); color: white; }
        .channel-btn.checked .ch-num, .channel-btn.checked .ch-name { color: white; }
        .channel-btn.failed { background: var(--accent-danger); border-color: var(--accent-danger); color: white; }
        .channel-btn.failed .ch-num, .channel-btn.failed .ch-name { color: white; }
        .channel-btn.start { border: 2px dashed var(--accent-info); }

        /* Router Counter */
        .router-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: var(--bg-input);
            border-radius: var(--radius-md);
        }

        .counter-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .counter-btn:hover { background: var(--accent-primary); border-color: var(--accent-primary); transform: scale(1.1); }

        .counter-display { text-align: center; }
        .counter-value { font-family: 'JetBrains Mono', monospace; font-size: 2.5rem; font-weight: 700; line-height: 1; }
        .counter-target { font-size: 0.8rem; color: var(--text-muted); margin-top: 4px; }
        .counter-target span { color: var(--accent-primary); font-weight: 600; }

        .counter-status {
            margin-top: 16px;
            padding: 10px;
            border-radius: var(--radius-sm);
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .counter-status.ok { background: rgba(16, 185, 129, 0.15); color: var(--accent-primary); border: 1px solid var(--accent-primary); }
        .counter-status.warning { background: rgba(245, 158, 11, 0.15); color: var(--accent-warning); border: 1px solid var(--accent-warning); }

        /* Notes */
        .notes-area {
            width: 100%;
            min-height: 80px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 12px;
            font-family: inherit;
            font-size: 0.85rem;
            color: var(--text-primary);
            resize: vertical;
            margin-top: 12px;
        }

        .notes-area:focus { outline: none; border-color: var(--border-focus); }
        .notes-area::placeholder { color: var(--text-muted); }

        /* Action Bar */
        .action-bar {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }

        /* Progress */
        .progress-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-top: 24px;
        }

        .progress-section h3 { font-size: 1rem; margin-bottom: 16px; color: var(--text-secondary); }

        .progress-bar-container {
            background: var(--bg-input);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), #059669);
            border-radius: 10px;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            font-size: 0.7rem;
            font-weight: 600;
            color: white;
        }

        .legend { display: flex; gap: 16px; flex-wrap: wrap; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-color); }
        .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.8rem; color: var(--text-secondary); }
        .legend-dot { width: 12px; height: 12px; border-radius: 3px; }
        .legend-dot.sencilla { background: var(--accent-info); }
        .legend-dot.doble { background: var(--accent-purple); }
        .legend-dot.presidencial { background: var(--accent-gold); }
        .legend-dot.audited { background: var(--accent-primary); }
        .legend-dot.issues { background: var(--accent-danger); }

        /* Reports Tab Styles */
        .dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; flex-wrap: wrap; gap: 16px; }
        .dashboard-header h2 { font-size: 1.5rem; display: flex; align-items: center; gap: 12px; }
        .dashboard-actions { display: flex; gap: 10px; flex-wrap: wrap; }

        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 24px; }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; }
        .kpi-card.green::before { background: var(--accent-primary); }
        .kpi-card.red::before { background: var(--accent-danger); }
        .kpi-card.yellow::before { background: var(--accent-warning); }
        .kpi-card.blue::before { background: var(--accent-info); }
        .kpi-card.purple::before { background: var(--accent-purple); }

        .kpi-icon { font-size: 2rem; margin-bottom: 12px; }
        .kpi-value { font-family: 'JetBrains Mono', monospace; font-size: 2.5rem; font-weight: 700; line-height: 1; margin-bottom: 8px; }
        .kpi-card.green .kpi-value { color: var(--accent-primary); }
        .kpi-card.red .kpi-value { color: var(--accent-danger); }
        .kpi-card.yellow .kpi-value { color: var(--accent-warning); }
        .kpi-card.blue .kpi-value { color: var(--accent-info); }
        .kpi-card.purple .kpi-value { color: var(--accent-purple); }
        .kpi-label { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 4px; }
        .kpi-sublabel { font-size: 0.75rem; color: var(--text-muted); }

        .charts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px; }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 20px;
        }

        .chart-card h3 { font-size: 1rem; color: var(--text-secondary); margin-bottom: 16px; }
        .chart-container { position: relative; height: 300px; }
        .chart-container.small { height: 250px; }

        .data-table-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 24px;
            overflow-x: auto;
        }

        .data-table-container h3 { font-size: 1rem; color: var(--text-secondary); margin-bottom: 16px; }

        .data-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .data-table th { background: var(--bg-secondary); padding: 12px 16px; text-align: left; font-weight: 600; color: var(--text-secondary); border-bottom: 2px solid var(--border-color); }
        .data-table td { padding: 12px 16px; border-bottom: 1px solid var(--border-color); }
        .data-table tr:hover td { background: var(--bg-input); }
        .data-table .status-ok { color: var(--accent-primary); font-weight: 600; }
        .data-table .status-fail { color: var(--accent-danger); font-weight: 600; }

        /* WiFi Heatmap Styles */
        .wifi-heatmap-container { }
        .heatmap-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }
        .legend-color.alta { background: #22c55e; }
        .legend-color.media { background: #f59e0b; }
        .legend-color.baja { background: #ef4444; }
        .legend-color.sin-datos { background: var(--bg-input); }
        .legend-color.necesita-router { background: linear-gradient(135deg, #ef4444, #f59e0b); }

        .heatmap-stats {
            display: flex;
            gap: 24px;
            margin-bottom: 20px;
            padding: 16px;
            background: var(--bg-input);
            border-radius: var(--radius-sm);
        }
        .wifi-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .wifi-stat .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        .wifi-stat .stat-value.green { color: #22c55e; }
        .wifi-stat .stat-value.yellow { color: #f59e0b; }
        .wifi-stat .stat-value.red { color: #ef4444; }
        .wifi-stat .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .heatmap-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }
        .heatmap-floor {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .heatmap-floor-label {
            width: 60px;
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .heatmap-rooms {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }
        .heatmap-room {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            font-weight: 600;
            border-radius: 4px;
            background: var(--bg-input);
            color: var(--text-muted);
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .heatmap-room:hover { transform: scale(1.2); z-index: 10; }
        .heatmap-room.alta { background: #22c55e; color: white; border-color: #16a34a; }
        .heatmap-room.media { background: #f59e0b; color: white; border-color: #d97706; }
        .heatmap-room.baja { background: #ef4444; color: white; border-color: #dc2626; animation: pulse-red 2s infinite; }
        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 6px rgba(239, 68, 68, 0); }
        }

        .heatmap-rooms-needing-router {
            margin-top: 16px;
            padding: 16px;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(245, 158, 11, 0.1));
            border: 1px solid var(--accent-danger);
            border-radius: var(--radius-sm);
        }
        .heatmap-rooms-needing-router h4 {
            font-size: 0.9rem;
            color: var(--accent-danger);
            margin-bottom: 12px;
        }
        .rooms-router-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            font-size: 0.85rem;
        }
        .router-needed-room {
            padding: 4px 10px;
            background: var(--accent-danger);
            color: white;
            border-radius: 4px;
            font-weight: 600;
        }
        .router-needed-room.media {
            background: var(--accent-warning);
        }

        /* TV Inventory Styles */
        .tv-inventory-container { }
        .tv-inventory-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        .tv-stat-card {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            text-align: center;
        }
        .tv-stat-card.hd-yes { border-left: 4px solid #22c55e; }
        .tv-stat-card.hd-no { border-left: 4px solid #ef4444; }
        .tv-stat-card.pending { border-left: 4px solid var(--text-muted); }
        .tv-stat-icon { font-size: 1.5rem; margin-bottom: 8px; }
        .tv-stat-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-primary);
        }
        .tv-stat-card.hd-yes .tv-stat-value { color: #22c55e; }
        .tv-stat-card.hd-no .tv-stat-value { color: #ef4444; }
        .tv-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 4px;
        }

        .inches-distribution {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        .inches-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--bg-input);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
        }
        .inches-label {
            font-weight: 600;
            color: var(--text-primary);
            min-width: 40px;
        }
        .inches-count {
            background: var(--accent-info);
            color: white;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .tv-needs-upgrade {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .tv-upgrade-room {
            padding: 6px 12px;
            background: var(--accent-danger);
            color: white;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        .tv-upgrade-room .room-inches {
            font-size: 0.7rem;
            opacity: 0.8;
            margin-left: 4px;
        }

        .tv-recommendation {
            margin-top: 20px;
            padding: 16px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
            border: 1px solid var(--accent-info);
            border-radius: var(--radius-md);
        }
        .tv-recommendation h4 {
            color: var(--accent-info);
            margin-bottom: 8px;
        }
        .tv-recommendation p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Panasonic Report Styles */
        .panasonic-report-container { }
        .panasonic-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        .panasonic-stat-card {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            text-align: center;
        }
        .panasonic-stat-card.standard { border-left: 4px solid #22c55e; }
        .panasonic-stat-card.panasonic { border-left: 4px solid #f59e0b; }
        .panasonic-stat-card.pending { border-left: 4px solid var(--text-muted); }
        .panasonic-stat-icon { font-size: 1.5rem; margin-bottom: 8px; }
        .panasonic-stat-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-primary);
        }
        .panasonic-stat-card.standard .panasonic-stat-value { color: #22c55e; }
        .panasonic-stat-card.panasonic .panasonic-stat-value { color: #f59e0b; }
        .panasonic-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 4px;
        }
        .panasonic-rooms-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .panasonic-room-badge {
            padding: 6px 12px;
            background: #f59e0b;
            color: white;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        .panasonic-recommendation {
            margin-top: 20px;
            padding: 16px;
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(234, 179, 8, 0.1));
            border: 1px solid #f59e0b;
            border-radius: var(--radius-md);
        }
        .panasonic-recommendation h4 {
            color: #f59e0b;
            margin-bottom: 8px;
        }
        .panasonic-recommendation p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .executive-summary {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-card));
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-bottom: 24px;
        }

        .executive-summary h2 { font-size: 1.3rem; margin-bottom: 20px; }
        .exec-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .exec-item { background: var(--bg-input); border-radius: var(--radius-sm); padding: 16px; }
        .exec-item h4 { font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 8px; }
        .exec-item p { font-size: 0.95rem; line-height: 1.5; }
        .exec-item .highlight { font-weight: 700; font-family: 'JetBrains Mono', monospace; }
        .exec-item .highlight.green { color: var(--accent-primary); }
        .exec-item .highlight.red { color: var(--accent-danger); }
        .exec-item .highlight.yellow { color: var(--accent-warning); }

        .issues-list { max-height: 400px; overflow-y: auto; }

        /* Estilos para Reportes por Tipo de Falla */
        .failure-report-container {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-card));
        }
        .failure-type-selector {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .failure-select {
            flex: 1;
            min-width: 250px;
            padding: 12px 16px;
            background: var(--bg-input);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .failure-select:focus {
            outline: none;
            border-color: var(--accent-primary);
        }
        .failure-select optgroup {
            font-weight: 700;
            color: var(--accent-primary);
        }
        .failure-report-result {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            min-height: 150px;
        }
        .failure-report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            background: rgba(16, 185, 129, 0.1);
        }
        .failure-report-header h4 {
            color: var(--accent-primary);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .failure-count-badge {
            background: var(--accent-danger);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        .failure-rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            padding: 20px;
        }
        .failure-room-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px 8px;
            background: var(--bg-secondary);
            border: 2px solid var(--accent-danger);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s;
        }
        .failure-room-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
            background: rgba(239, 68, 68, 0.1);
        }
        .failure-room-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent-danger);
        }
        .failure-room-floor {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 2px;
        }
        .failure-report-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .failure-report-actions .action-btn {
            padding: 10px 20px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .failure-report-actions .action-btn:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }
        .failure-by-floor {
            padding: 20px;
            border-top: 1px solid var(--border-color);
        }
        .failure-floor-group {
            margin-bottom: 15px;
        }
        .failure-floor-title {
            font-size: 0.85rem;
            color: var(--accent-info);
            font-weight: 600;
            margin-bottom: 8px;
            padding: 5px 10px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: var(--radius-sm);
            display: inline-block;
        }
        .failure-floor-rooms {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .failure-room-badge {
            padding: 6px 14px;
            background: var(--accent-danger);
            color: white;
            border-radius: 4px;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
        }
        
        /* Resumen general de fallas */
        .all-failures-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }
        .failure-summary-card {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid var(--accent-danger);
        }
        .failure-summary-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border-color: var(--accent-primary);
        }
        .failure-summary-card.no-failures {
            border-left-color: var(--accent-primary);
            opacity: 0.6;
        }
        .failure-summary-icon {
            font-size: 1.5rem;
        }
        .failure-summary-info {
            flex: 1;
        }
        .failure-summary-name {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        .failure-summary-count {
            font-size: 1.3rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-danger);
        }
        .failure-summary-card.no-failures .failure-summary-count {
            color: var(--accent-primary);
        }

        /* Estilos para Reportes por Piso */
        .floor-report-container {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-card));
        }
        .floor-selector-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .floor-selector-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        @media (max-width: 480px) {
            .floor-selector-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        .floor-select-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 16px 12px;
            background: var(--bg-input);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .floor-select-btn:hover {
            border-color: var(--accent-primary);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.2);
        }
        .floor-select-btn.active {
            border-color: var(--accent-primary);
            background: rgba(16, 185, 129, 0.1);
        }
        .floor-select-btn .floor-number {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-primary);
            line-height: 1;
        }
        .floor-select-btn .floor-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        .floor-select-btn .floor-issues-count {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 6px;
            padding: 2px 8px;
            background: var(--bg-secondary);
            border-radius: 10px;
        }
        .floor-select-btn .floor-issues-count.has-issues {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-danger);
        }
        .floor-report-result {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            min-height: 200px;
            max-height: 600px;
            overflow-y: auto;
        }
        .floor-report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            background: rgba(59, 130, 246, 0.1);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .floor-report-header h4 {
            color: var(--accent-info);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .floor-stats-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .floor-stat-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
            font-family: 'JetBrains Mono', monospace;
        }
        .floor-stat-badge.audited {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-primary);
        }
        .floor-stat-badge.issues {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-danger);
        }
        .floor-stat-badge.pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--accent-warning);
        }
        .floor-room-section {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
        }
        .floor-room-section:last-child {
            border-bottom: none;
        }
        .floor-room-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .floor-room-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-info);
        }
        .floor-room-type {
            font-size: 0.75rem;
            padding: 3px 10px;
            background: var(--bg-secondary);
            border-radius: 10px;
            color: var(--text-muted);
        }
        .floor-room-type.suite {
            background: rgba(236, 72, 153, 0.2);
            color: var(--accent-pink);
        }
        .floor-room-type.presidencial {
            background: rgba(234, 179, 8, 0.2);
            color: var(--accent-gold);
        }
        .floor-room-issues {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .floor-issue-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--accent-danger);
            border-radius: 4px;
        }
        .floor-issue-icon {
            font-size: 1rem;
        }
        .floor-issue-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .floor-room-ok {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(16, 185, 129, 0.1);
            border-left: 3px solid var(--accent-primary);
            border-radius: 4px;
            color: var(--accent-primary);
            font-size: 0.85rem;
        }
        .floor-no-issues {
            padding: 30px;
            text-align: center;
            color: var(--accent-primary);
        }
        .floor-no-issues .icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        .floor-report-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .floor-report-actions .action-btn {
            padding: 10px 20px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .floor-report-actions .action-btn:hover {
            background: var(--accent-info);
            border-color: var(--accent-info);
            color: white;
        }

        .issue-row {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-input);
            border-radius: var(--radius-sm);
            margin-bottom: 8px;
            border-left: 3px solid var(--accent-danger);
        }

        .issue-room { font-family: 'JetBrains Mono', monospace; font-weight: 600; color: var(--accent-info); min-width: 60px; }
        .issue-type { font-size: 0.75rem; padding: 2px 8px; border-radius: 10px; background: var(--bg-secondary); color: var(--text-muted); }
        .issue-category { color: var(--accent-warning); font-weight: 500; }
        .issue-detail { flex: 1; color: var(--text-secondary); font-size: 0.85rem; }

        /* Multi-room selector modal */
        .multi-select-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            overflow-y: auto;
            padding: 20px;
        }

        .multi-select-modal.active {
            display: block;
        }

        .multi-select-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            max-width: 900px;
            width: 100%;
            margin: 20px auto;
            display: flex;
            flex-direction: column;
            max-height: calc(100vh - 40px);
        }

        .multi-select-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .multi-select-header h2 {
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .multi-select-body {
            padding: 20px;
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            min-height: 200px;
        }

        .multi-select-body::-webkit-scrollbar {
            width: 8px;
        }

        .multi-select-body::-webkit-scrollbar-track {
            background: var(--bg-input);
            border-radius: 4px;
        }

        .multi-select-body::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 4px;
        }

        .multi-select-body::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        .multi-select-floor {
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px dashed var(--border-color);
        }

        .multi-select-floor:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .multi-select-floor-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            padding: 10px 12px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
        }

        .multi-select-floor-header h3 {
            font-size: 1rem;
            color: var(--text-primary);
        }

        .floor-select-all {
            margin-left: auto;
            font-size: 0.8rem;
            color: var(--accent-primary);
            cursor: pointer;
            padding: 4px 12px;
            background: rgba(16, 185, 129, 0.15);
            border-radius: var(--radius-sm);
            transition: all 0.2s;
        }

        .floor-select-all:hover {
            background: var(--accent-primary);
            color: white;
        }

        .multi-select-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 8px;
        }

        .multi-select-room {
            padding: 10px 8px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-input);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            text-align: center;
            position: relative;
        }

        .multi-select-room:hover {
            border-color: var(--accent-info);
            transform: scale(1.05);
        }

        .multi-select-room.selected {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .multi-select-room.audited::after {
            content: '✓';
            position: absolute;
            top: 2px;
            right: 4px;
            font-size: 0.6rem;
            color: var(--accent-primary);
        }

        .multi-select-room.selected.audited::after {
            color: white;
        }

        .multi-select-room.not-audited {
            opacity: 0.5;
        }

        .multi-select-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .selected-count {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .selected-count strong {
            color: var(--accent-primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .multi-select-actions {
            display: flex;
            gap: 10px;
        }

        .quick-input {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg-input);
            border-radius: var(--radius-sm);
        }

        .quick-input label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .quick-input input {
            flex: 1;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 8px 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .quick-input input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        /* Room Report Modal */
        .room-report-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            overflow-y: auto;
            padding: 20px;
        }

        .room-report-modal.active {
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .room-report {
            background: white;
            color: #1a1a1a;
            max-width: 800px;
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            margin: 20px auto;
        }

        .report-header {
            background: linear-gradient(135deg, #1e3a5f, #2d5a87);
            color: white;
            padding: 24px;
            text-align: center;
        }

        .report-header h1 {
            font-size: 1.5rem;
            margin-bottom: 4px;
        }

        .report-header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .report-room-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 24px;
            border-radius: 30px;
            font-size: 2rem;
            font-weight: 700;
            margin: 16px 0;
            font-family: 'JetBrains Mono', monospace;
        }

        .report-room-type {
            display: inline-block;
            padding: 4px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .report-room-type.sencilla { background: #3b82f6; }
        .report-room-type.doble { background: #8b5cf6; }
        .report-room-type.presidencial { background: linear-gradient(135deg, #eab308, #f59e0b); }

        .report-meta {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 16px;
            font-size: 0.85rem;
        }

        .report-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .report-body {
            padding: 24px;
        }

        .report-section {
            margin-bottom: 24px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }

        .report-section-header {
            background: #f3f4f6;
            padding: 12px 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #e5e7eb;
        }

        .report-section-header .icon {
            font-size: 1.2rem;
        }

        .report-section-status {
            margin-left: auto;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .report-section-status.ok { background: #dcfce7; color: #166534; }
        .report-section-status.fail { background: #fee2e2; color: #991b1b; }
        .report-section-status.pending { background: #fef3c7; color: #92400e; }

        .report-checks {
            padding: 16px;
        }

        .report-check-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .report-check-item:last-child {
            border-bottom: none;
        }

        .report-check-label {
            flex: 1;
            font-size: 0.9rem;
        }

        .report-check-status {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .report-check-status.ok { background: #dcfce7; color: #166534; }
        .report-check-status.fail { background: #fee2e2; color: #991b1b; }
        .report-check-status.na { background: #f3f4f6; color: #6b7280; }
        .report-check-status.pending { background: #fef3c7; color: #92400e; }

        .report-channels-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            padding: 16px;
        }

        .report-channel {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .report-channel.ok { background: #dcfce7; color: #166534; }
        .report-channel.fail { background: #fee2e2; color: #991b1b; }
        .report-channel.pending { background: #f3f4f6; color: #9ca3af; }

        .report-notes {
            background: #fffbeb;
            border: 1px solid #fcd34d;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        .report-notes h4 {
            font-size: 0.85rem;
            color: #92400e;
            margin-bottom: 8px;
        }

        .report-notes p {
            font-size: 0.9rem;
            color: #78350f;
            white-space: pre-wrap;
        }

        .report-summary {
            background: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 24px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            text-align: center;
        }

        .report-summary-item h4 {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .report-summary-item .value {
            font-size: 1.5rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .report-summary-item .value.green { color: #16a34a; }
        .report-summary-item .value.red { color: #dc2626; }
        .report-summary-item .value.yellow { color: #ca8a04; }

        .report-footer {
            background: #f8fafc;
            padding: 16px 24px;
            text-align: center;
            font-size: 0.8rem;
            color: #64748b;
            border-top: 1px solid #e5e7eb;
        }

        .report-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
            padding: 20px;
            background: #1a1a1a;
        }

        .report-actions .btn {
            min-width: 150px;
            justify-content: center;
        }

        /* Print styles - Dashboard de Reportes */
        @media print {
            /* Reset completo para impresión */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            body {
                background: white !important;
                color: #000 !important;
                font-size: 11pt !important;
            }
            
            /* Ocultar elementos no necesarios para impresión */
            .no-print,
            .connection-bar,
            .config-panel,
            .nav-buttons,
            .action-bar,
            .main-tabs,
            .loading-overlay,
            .cloud-badge,
            .toast-container,
            .room-grid-section,
            .header-inputs,
            #audit-tab,
            #config-tab,
            .dashboard-actions,
            .modal-overlay,
            .btn {
                display: none !important;
            }
            
            /* Mostrar solo reportes */
            #reports-tab {
                display: block !important;
            }
            
            /* Forzar colores oscuros en TODOS los textos */
            h1, h2, h3, h4, h5, h6,
            p, span, div, td, th, li,
            .kpi-value, .kpi-label, .kpi-trend,
            .summary-value, .summary-label,
            .highlight, .chart-title,
            .exec-label, .exec-value,
            .section-title, label {
                color: #000 !important;
            }
            
            /* Contenedores con fondo blanco */
            .header, 
            .executive-summary, 
            .chart-card, 
            .data-table-container, 
            .kpi-grid, 
            .kpi-card,
            .report-section,
            .exec-item,
            .summary-item {
                background: white !important;
                border: 1px solid #999 !important;
                box-shadow: none !important;
                page-break-inside: avoid;
            }
            
            /* Header específico */
            .header {
                border-bottom: 2px solid #333 !important;
                margin-bottom: 20px !important;
                padding-bottom: 15px !important;
            }
            
            .logo-section {
                background: transparent !important;
            }
            
            .logo-icon {
                font-size: 2rem !important;
                color: #333 !important;
            }
            
            .title-group h1 {
                color: #000 !important;
                font-size: 18pt !important;
            }
            
            .title-group p {
                color: #333 !important;
                font-size: 12pt !important;
            }
            
            /* Tablas */
            .data-table {
                border-collapse: collapse !important;
                width: 100% !important;
            }
            
            .data-table th {
                background: #e0e0e0 !important;
                color: #000 !important;
                border: 1px solid #999 !important;
                padding: 8px !important;
            }
            
            .data-table td {
                border: 1px solid #999 !important;
                color: #000 !important;
                padding: 6px !important;
                background: white !important;
            }
            
            .data-table tr:nth-child(even) td {
                background: #f5f5f5 !important;
            }
            
            /* KPIs */
            .kpi-card {
                padding: 15px !important;
                margin: 5px !important;
            }
            
            .kpi-value {
                font-size: 24pt !important;
                font-weight: bold !important;
            }
            
            /* Resumen ejecutivo */
            .exec-item {
                background: #f0f0f0 !important;
                padding: 10px !important;
                margin: 5px 0 !important;
            }
            
            .exec-label {
                font-weight: bold !important;
            }
            
            /* Gráficas */
            .chart-card {
                page-break-inside: avoid !important;
            }
            
            .chart-card canvas {
                max-width: 100% !important;
                height: auto !important;
            }
            
            /* Status badges para impresión */
            .status-ok, .status-success {
                background: #d4edda !important;
                color: #155724 !important;
                border: 1px solid #155724 !important;
            }
            
            .status-warning {
                background: #fff3cd !important;
                color: #856404 !important;
                border: 1px solid #856404 !important;
            }
            
            .status-error, .status-fail {
                background: #f8d7da !important;
                color: #721c24 !important;
                border: 1px solid #721c24 !important;
            }
            
            /* WiFi Heatmap print styles */
            .wifi-heatmap-container {
                page-break-inside: avoid !important;
            }
            .heatmap-legend {
                background: #f5f5f5 !important;
            }
            .heatmap-stats {
                background: #f5f5f5 !important;
            }
            .wifi-stat .stat-value {
                color: #000 !important;
            }
            .wifi-stat .stat-value.green { color: #16a34a !important; }
            .wifi-stat .stat-value.yellow { color: #d97706 !important; }
            .wifi-stat .stat-value.red { color: #dc2626 !important; }
            .heatmap-room {
                border: 1px solid #999 !important;
                width: 28px !important;
                height: 28px !important;
                font-size: 0.55rem !important;
            }
            .heatmap-room.alta { background: #22c55e !important; color: white !important; }
            .heatmap-room.media { background: #f59e0b !important; color: white !important; }
            .heatmap-room.baja { background: #ef4444 !important; color: white !important; }
            .heatmap-rooms-needing-router {
                background: #fff !important;
                border: 2px solid #dc2626 !important;
            }
            .heatmap-rooms-needing-router h4 {
                color: #dc2626 !important;
            }
            .router-needed-room {
                background: #dc2626 !important;
                color: white !important;
            }
            .router-needed-room.media {
                background: #d97706 !important;
            }
        }
        
        /* Print styles - Modal de habitación individual */
        @media print {
            .room-report-modal {
                position: fixed !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                height: auto !important;
                background: white !important;
                z-index: 99999 !important;
            }
            
            .room-report-modal .report-actions {
                display: none !important;
            }
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-overlay.hidden { display: none; }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loading-text { color: var(--text-secondary); font-size: 1rem; }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
            box-shadow: var(--shadow-lg);
        }

        .toast.success { border-left: 3px solid var(--accent-primary); }
        .toast.error { border-left: 3px solid var(--accent-danger); }
        .toast.warning { border-left: 3px solid var(--accent-warning); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .charts-grid { grid-template-columns: 1fr; }
            .kpi-grid { grid-template-columns: repeat(2, 1fr); }
            .main-tab span { display: none; }
        }

        @media (max-width: 600px) {
            .container { padding: 12px; }
            .header-top { flex-direction: column; }
            .summary-grid { grid-template-columns: repeat(3, 1fr); }
            .room-nav-top { flex-direction: column; align-items: stretch; }
            .nav-buttons { justify-content: center; }
            .action-bar { flex-direction: column; }
            .btn { justify-content: center; }
            .kpi-grid { grid-template-columns: 1fr; }
        }

        @media print {
            /* Estilos adicionales para tablas en impresión */
            .data-table td {
                color: #000 !important;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-container">
            <div class="login-logo">
                <div class="logo-icon"><img id="loginLogoImg" src="" alt="Hotel Sheraton Chihuahua Soberano"></div>
                <h1>Auditoría de Sistemas</h1>
            </div>
            <form class="login-form" onsubmit="handleLogin(event)">
                <div class="login-field">
                    <label>Usuario</label>
                    <input type="text" id="loginUsername" placeholder="Ingresa tu usuario" required autocomplete="username">
                </div>
                <div class="login-field">
                    <label>Contraseña</label>
                    <input type="password" id="loginPassword" placeholder="Ingresa tu contraseña" required autocomplete="current-password">
                </div>
                <div class="login-error" id="loginError">Usuario o contraseña incorrectos</div>
                <button type="submit" class="login-btn" id="loginBtn">Iniciar Sesión</button>
            </form>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Conectando con la nube...</div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Modal de Historial -->
    <div class="modal-overlay" id="historyModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>📜 Historial de Habitación <span id="historyRoomNumber"></span></h3>
                <button class="modal-close" onclick="closeHistoryModal()">✕</button>
            </div>
            <div class="modal-body" id="historyContent">
                <p style="text-align: center; color: var(--text-muted);">Cargando historial...</p>
            </div>
        </div>
    </div>

    <style>
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }
        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 800px;
            max-height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }
        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: var(--radius-sm);
        }
        .modal-close:hover {
            background: var(--bg-input);
            color: var(--text-primary);
        }
        .modal-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }
        .history-item {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 12px;
        }
        .history-item.has-issues {
            border-left: 4px solid var(--accent-danger);
        }
        .history-item.no-issues {
            border-left: 4px solid var(--accent-primary);
        }
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .history-date {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent-info);
        }
        .history-auditor {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .history-auditor strong {
            color: var(--text-primary);
        }
        .history-issues {
            font-size: 0.85rem;
            padding: 4px 10px;
            border-radius: 20px;
        }
        .history-issues.danger {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-danger);
        }
        .history-issues.success {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-primary);
        }
        .history-details {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .history-details ul {
            margin: 8px 0 0 20px;
            padding: 0;
        }
        .history-details li {
            margin-bottom: 4px;
        }
        .history-notes {
            margin-top: 10px;
            padding: 10px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-style: italic;
            color: var(--text-muted);
        }
        .history-summary {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-card));
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 20px;
        }
        .history-summary h4 {
            margin: 0 0 12px 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        .history-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
        }
        .history-stat {
            text-align: center;
        }
        .history-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
        }
        .history-stat-value.green { color: var(--accent-primary); }
        .history-stat-value.red { color: var(--accent-danger); }
        .history-stat-value.yellow { color: var(--accent-warning); }
        .history-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }
    </style>

    <!-- Room Report Modal -->
    <div class="room-report-modal" id="roomReportModal">
        <div class="room-report" id="roomReportContent">
            <!-- Se genera dinámicamente -->
        </div>
    </div>

    <!-- Multi-room Select Modal -->
    <div class="multi-select-modal" id="multiSelectModal">
        <div class="multi-select-container">
            <div class="multi-select-header">
                <h2>📋 Seleccionar Habitaciones para Reporte</h2>
                <button class="btn" onclick="closeMultiSelect()">✕ Cerrar</button>
            </div>
            <div class="multi-select-body">
                <div class="quick-input">
                    <label>Agregar rápido:</label>
                    <input type="text" id="quickRoomInput" placeholder="Ej: 110, 433, 528" onkeypress="if(event.key==='Enter')addQuickRooms()">
                    <button class="btn btn-primary" onclick="addQuickRooms()">+ Agregar</button>
                </div>
                <div style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 16px; text-align: center;">
                    ⬇️ Desplázate para ver todos los pisos (1-5) ⬇️
                </div>
                <div id="multiSelectFloors">
                    <!-- Se genera dinámicamente -->
                </div>
            </div>
            <div class="multi-select-footer">
                <div class="selected-count">
                    Seleccionadas: <strong id="selectedRoomCount">0</strong> habitaciones
                </div>
                <div class="multi-select-actions">
                    <button class="btn" onclick="clearRoomSelection()">Limpiar selección</button>
                    <button class="btn" onclick="selectAllAudited()">Seleccionar auditadas</button>
                    <button class="btn btn-primary" onclick="generateMultiReport()" id="generateReportBtn">🖨️ Generar Reporte</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Connection Status Bar -->
        <div class="connection-bar no-print">
            <div class="connection-status">
                <div class="status-dot" id="statusDot"></div>
                <div class="connection-info">
                    <strong id="connectionText">Conectando...</strong>
                    <span id="lastSync"></span>
                </div>
            </div>
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <div class="user-badge" id="userBadge">
                    <div class="user-icon" id="userIcon">--</div>
                    <div class="user-info">
                        <span class="user-name" id="userName">---</span>
                        <span class="user-role" id="userRole">---</span>
                    </div>
                </div>
                <button class="logout-btn" onclick="handleLogout()">Cerrar Sesión</button>
                <span id="activeUsers" style="font-size: 0.8rem; color: var(--text-muted);"></span>
                <button class="sync-btn" onclick="syncData()" id="syncBtn">
                    <span class="sync-icon">🔄</span> Sincronizar
                </button>
            </div>
        </div>

        <!-- Config Panel (shown if no API URL) -->
        <div class="config-panel" id="configPanel">
            <h3>⚠️ Configuración Requerida</h3>
            <p style="margin-bottom: 12px; font-size: 0.9rem;">Ingresa la URL del Google Apps Script para conectar con la nube:</p>
            <input type="text" id="apiUrlInput" placeholder="https://script.google.com/macros/s/xxx/exec">
            <button onclick="saveApiUrl()">Guardar y Conectar</button>
            <p style="margin-top: 12px; font-size: 0.8rem; opacity: 0.8;">📖 Consulta la guía de instalación para obtener esta URL</p>
        </div>

        <!-- Main Tabs -->
        <div class="main-tabs no-print">
            <button class="main-tab active" onclick="switchTab('audit')">📋 <span>Auditoría</span></button>
            <button class="main-tab" onclick="switchTab('reports')">📊 <span>Reportes</span></button>
        </div>

        <!-- TAB 1: AUDITORÍA -->
        <div id="audit-tab" class="tab-content active">
            <header class="header">
                <div class="header-top">
                    <div class="logo-section">
                        <div class="logo-icon"><img class="header-logo-img" src="" alt=""></div>
                        <div class="title-group">
                            <h1>Auditoría de Sistemas</h1>
                            <p>Hotel Sheraton Chihuahua Soberano</p>
                        </div>
                        <div class="cloud-badge">☁️ En la Nube</div>
                    </div>
                    <div class="date-display" id="currentDate"></div>
                </div>
                <div class="header-inputs">
                    <div class="input-group">
                        <label>Tu Nombre</label>
                        <input type="text" id="auditorName" placeholder="Ej: Edel Chávez">
                    </div>
                    <div class="input-group">
                        <label>Turno</label>
                        <select id="shift">
                            <option value="matutino">Matutino</option>
                            <option value="vespertino">Vespertino</option>
                            <option value="nocturno">Nocturno</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Filtrar</label>
                        <select id="filterType" onchange="filterRooms()">
                            <option value="">Todas</option>
                            <option value="sencilla">Sencillas</option>
                            <option value="doble">Dobles</option>
                            <option value="suite">Suites</option>
                            <option value="presidencial">Presidencial</option>
                            <option value="pending">Pendientes</option>
                            <option value="audited">Auditadas</option>
                            <option value="issues">Con Incidencias</option>
                        </select>
                    </div>
                </div>
            </header>

            <!-- Summary Cards -->
            <div class="summary-grid">
                <div class="summary-card success">
                    <div class="summary-value" id="roomsAudited">0</div>
                    <div class="summary-label">Auditadas</div>
                </div>
                <div class="summary-card purple">
                    <div class="summary-value" id="roomsPending">204</div>
                    <div class="summary-label">Pendientes</div>
                </div>
                <div class="summary-card danger">
                    <div class="summary-value" id="issuesFound">0</div>
                    <div class="summary-label">Incidencias</div>
                </div>
                <div class="summary-card warning">
                    <div class="summary-value" id="phoneMissing">0</div>
                    <div class="summary-label">Tel. Faltantes</div>
                </div>
                <div class="summary-card info">
                    <div class="summary-value" id="routerCount">0</div>
                    <div class="summary-label">Routers/42</div>
                </div>
            </div>

            <!-- Room Navigation -->
            <div class="room-nav">
                <div class="room-nav-top">
                    <div class="room-selector">
                        <label>Habitación:</label>
                        <input type="text" class="room-input" id="roomNumber" placeholder="101" maxlength="4" onchange="loadRoomByInput()">
                        <span class="room-type-badge" id="roomTypeBadge">-</span>
                    </div>
                    <div class="nav-buttons">
                        <button class="btn" onclick="previousRoom()">← Anterior</button>
                        <button class="btn" onclick="nextRoom()">Siguiente →</button>
                        <button class="btn btn-primary" onclick="saveRoom()" id="saveBtn">💾 Guardar en Nube</button>
                        <button class="btn btn-info" onclick="showHistory()">📜 Historial</button>
                        <button class="btn btn-info" onclick="printRoomReport()">🖨️ Esta Hab.</button>
                        <button class="btn btn-info" onclick="openMultiSelect()">📋 Varias Hab.</button>
                        <button class="btn" onclick="clearRoom()">🔄 Limpiar</button>
                    </div>
                </div>
                <div class="room-grid-section">
                    <div class="floor-tabs" id="floorTabs"></div>
                    <div class="room-grid" id="roomGrid"></div>
                </div>
            </div>

            <!-- Audit Sections -->
            <section class="audit-section">
                <div class="section-header" onclick="toggleSection('screen')">
                    <div class="section-icon tv">📺</div>
                    <div class="section-title">1. Pantalla(s)</div>
                    <div class="section-status" id="screen-status">Pendiente</div>
                </div>
                <div class="section-content" id="screen-content">
                    <!-- TV Principal (todas las habitaciones) -->
                    <h4 style="color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem;">📺 TV Principal</h4>
                    
                    <!-- Especificaciones de TV -->
                    <div class="tv-specs-grid">
                        <div class="check-item tv-spec-item" id="tv1-inches-item">
                            <label>Pulgadas</label>
                            <select id="tv1-inches" class="tv-spec-select" onchange="onTVSpecChange(1, 'inches')">
                                <option value="">-- Seleccionar --</option>
                                <option value="32">32"</option>
                                <option value="37">37"</option>
                                <option value="40">40"</option>
                                <option value="42">42"</option>
                                <option value="43">43"</option>
                                <option value="47">47"</option>
                                <option value="49">49"</option>
                                <option value="50">50"</option>
                                <option value="55">55"</option>
                                <option value="65">65"</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                        <div class="check-item tv-spec-item" id="tv1-hd-item">
                            <label>¿Soporta HD?</label>
                            <div class="toggle-group hd-toggle">
                                <button class="toggle-btn hd-yes" id="tv1-hd-yes" onclick="setTVHD(1, true)">✓ SÍ HD</button>
                                <button class="toggle-btn hd-no" id="tv1-hd-no" onclick="setTVHD(1, false)">✗ NO HD</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="check-grid">
                        <div class="check-item" id="screen-power">
                            <div class="check-label">Pantalla enciende correctamente<small>Verificar que la TV prenda sin problemas</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('screen-power', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('screen-power', 'fail')">FALLA</button>
                            </div>
                        </div>
                        <div class="check-item" id="screen-remote">
                            <div class="check-label">Control remoto funcional<small>Verificar todas las funciones</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('screen-remote', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('screen-remote', 'fail')">FALLA</button>
                            </div>
                        </div>
                        <div class="check-item" id="screen-image">
                            <div class="check-label">Calidad de imagen<small>Sin líneas, manchas o distorsiones</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('screen-image', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('screen-image', 'fail')">FALLA</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- TV Secundaria (Solo Suite y Presidencial) -->
                    <div id="second-tv-section" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 1px dashed var(--border-color);">
                        <h4 style="color: var(--accent-pink); margin-bottom: 12px; font-size: 0.9rem;">📺 TV Secundaria (Recámara)</h4>
                        
                        <!-- Especificaciones de TV2 -->
                        <div class="tv-specs-grid">
                            <div class="check-item tv-spec-item" id="tv2-inches-item">
                                <label>Pulgadas</label>
                                <select id="tv2-inches" class="tv-spec-select" onchange="onTVSpecChange(2, 'inches')">
                                    <option value="">-- Seleccionar --</option>
                                    <option value="32">32"</option>
                                    <option value="37">37"</option>
                                    <option value="40">40"</option>
                                    <option value="42">42"</option>
                                    <option value="43">43"</option>
                                    <option value="47">47"</option>
                                    <option value="49">49"</option>
                                    <option value="50">50"</option>
                                    <option value="55">55"</option>
                                    <option value="65">65"</option>
                                    <option value="otro">Otro</option>
                                </select>
                            </div>
                            <div class="check-item tv-spec-item" id="tv2-hd-item">
                                <label>¿Soporta HD?</label>
                                <div class="toggle-group hd-toggle">
                                    <button class="toggle-btn hd-yes" id="tv2-hd-yes" onclick="setTVHD(2, true)">✓ SÍ HD</button>
                                    <button class="toggle-btn hd-no" id="tv2-hd-no" onclick="setTVHD(2, false)">✗ NO HD</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="check-grid">
                            <div class="check-item" id="screen2-power">
                                <div class="check-label">Pantalla 2 enciende correctamente<small>Verificar que la TV prenda sin problemas</small></div>
                                <div class="toggle-group">
                                    <button class="toggle-btn ok" onclick="setCheck('screen2-power', 'ok')">OK</button>
                                    <button class="toggle-btn fail" onclick="setCheck('screen2-power', 'fail')">FALLA</button>
                                </div>
                            </div>
                            <div class="check-item" id="screen2-remote">
                                <div class="check-label">Control remoto 2 funcional<small>Verificar todas las funciones</small></div>
                                <div class="toggle-group">
                                    <button class="toggle-btn ok" onclick="setCheck('screen2-remote', 'ok')">OK</button>
                                    <button class="toggle-btn fail" onclick="setCheck('screen2-remote', 'fail')">FALLA</button>
                                </div>
                            </div>
                            <div class="check-item" id="screen2-image">
                                <div class="check-label">Calidad de imagen 2<small>Sin líneas, manchas o distorsiones</small></div>
                                <div class="toggle-group">
                                    <button class="toggle-btn ok" onclick="setCheck('screen2-image', 'ok')">OK</button>
                                    <button class="toggle-btn fail" onclick="setCheck('screen2-image', 'fail')">FALLA</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="audit-section">
                <div class="section-header" onclick="toggleSection('channels')">
                    <div class="section-icon tv">📡</div>
                    <div class="section-title">2. Canales de TV</div>
                    <div class="section-status" id="channels-status">Pendiente</div>
                </div>
                <div class="section-content" id="channels-content">
                    <div class="channel-info">ℹ️ <strong>Secuencia:</strong> Inicia en <strong>#62</strong> → cambia a <strong>#5</strong> → continúa hasta <strong>#63</strong></div>
                    <div class="check-item" id="channel-startup" style="margin-bottom: 12px;">
                        <div class="check-label">Inicia en canal #62 al encender<small>Verificar canal de inicio correcto</small></div>
                        <div class="toggle-group">
                            <button class="toggle-btn ok" onclick="setCheck('channel-startup', 'ok')">OK</button>
                            <button class="toggle-btn fail" onclick="setCheck('channel-startup', 'fail')">FALLA</button>
                        </div>
                    </div>
                    <p style="margin-bottom: 10px; color: var(--text-secondary); font-size: 0.8rem;">Click = <span style="color: var(--accent-primary);">OK</span> | Doble click = <span style="color: var(--accent-danger);">Falla</span></p>
                    <div class="channel-grid" id="channelGrid"></div>
                </div>
            </section>

            <section class="audit-section">
                <div class="section-header" onclick="toggleSection('phone')">
                    <div class="section-icon phone">📞</div>
                    <div class="section-title">3. Telefonía</div>
                    <div class="section-status" id="phone-status">Pendiente</div>
                </div>
                <div class="section-content" id="phone-content">
                    <div class="check-grid">
                        <div class="check-item" id="phone-desk">
                            <div class="check-label">Teléfono de escritorio<small>Línea, tono y llamadas</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('phone-desk', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('phone-desk', 'fail')">FALLA</button>
                            </div>
                        </div>
                        <div class="check-item" id="phone-nightstand">
                            <div class="check-label">Teléfono de buró<small>N/A = No cuenta con teléfono</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('phone-nightstand', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('phone-nightstand', 'fail')">FALLA</button>
                                <button class="toggle-btn na" onclick="setCheck('phone-nightstand', 'na')">N/A</button>
                            </div>
                        </div>
                        <div class="check-item" id="phone-battery">
                            <div class="check-label">Batería de auriculares<small>Carga y funcionamiento</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('phone-battery', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('phone-battery', 'fail')">FALLA</button>
                                <button class="toggle-btn na" onclick="setCheck('phone-battery', 'na')">N/A</button>
                            </div>
                        </div>
                        <div class="check-item" id="phone-condition">
                            <div class="check-label">Condición física del equipo<small>Sin daños, cables en buen estado</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('phone-condition', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('phone-condition', 'fail')">FALLA</button>
                            </div>
                        </div>
                        <div class="check-item" id="phone-panasonic">
                            <div class="check-label">¿Teléfono Panasonic?<small>Equipo NO estándar del hotel</small></div>
                            <div class="toggle-group panasonic-toggle">
                                <button class="toggle-btn panasonic-yes" onclick="setCheck('phone-panasonic', 'si')">⚠️ SÍ Panasonic</button>
                                <button class="toggle-btn panasonic-no" onclick="setCheck('phone-panasonic', 'no')">✓ NO (Estándar)</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="audit-section">
                <div class="section-header" onclick="toggleSection('network')">
                    <div class="section-icon network">🌐</div>
                    <div class="section-title">4. Nodo de Internet</div>
                    <div class="section-status" id="network-status">Pendiente</div>
                </div>
                <div class="section-content" id="network-content">
                    <div class="check-grid">
                        <div class="check-item" id="network-wall">
                            <div class="check-label">Nodo de pared funcional<small>Puerto RJ45 en buenas condiciones</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('network-wall', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('network-wall', 'fail')">FALLA</button>
                            </div>
                        </div>
                        <div class="check-item" id="network-connection">
                            <div class="check-label">Conexión activa<small>Luz de enlace al conectar</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('network-connection', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('network-connection', 'fail')">FALLA</button>
                            </div>
                        </div>
                        <div class="check-item" id="network-speed">
                            <div class="check-label">Listo para router<small>Velocidad adecuada</small></div>
                            <div class="toggle-group">
                                <button class="toggle-btn ok" onclick="setCheck('network-speed', 'ok')">OK</button>
                                <button class="toggle-btn fail" onclick="setCheck('network-speed', 'fail')">FALLA</button>
                                <button class="toggle-btn na" onclick="setCheck('network-speed', 'na')">N/A</button>
                            </div>
                        </div>
                        <div class="check-item" id="wifi-coverage">
                            <div class="check-label">Cobertura WiFi<small>Señal detectada en la habitación</small></div>
                            <div class="toggle-group coverage-group">
                                <button class="toggle-btn coverage-low" onclick="setCheck('wifi-coverage', 'baja')">📶 BAJA</button>
                                <button class="toggle-btn coverage-med" onclick="setCheck('wifi-coverage', 'media')">📶 MEDIA</button>
                                <button class="toggle-btn coverage-high" onclick="setCheck('wifi-coverage', 'alta')">📶 ALTA</button>
                                <button class="toggle-btn na" onclick="setCheck('wifi-coverage', 'na')">N/A</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="audit-section">
                <div class="section-header" onclick="toggleSection('routers')">
                    <div class="section-icon router">📶</div>
                    <div class="section-title">5. Conteo General de Routers</div>
                    <div class="section-status" id="routers-status">Pendiente</div>
                </div>
                <div class="section-content" id="routers-content">
                    <div class="router-counter">
                        <button class="counter-btn" onclick="updateRouterCount(-1)">−</button>
                        <div class="counter-display">
                            <div class="counter-value" id="routerCounterValue">0</div>
                            <div class="counter-target">Meta: <span>42 routers</span></div>
                        </div>
                        <button class="counter-btn" onclick="updateRouterCount(1)">+</button>
                    </div>
                    <div class="counter-status" id="routerStatus"></div>
                    <textarea class="notes-area" id="routerNotes" placeholder="Notas sobre routers..."></textarea>
                    <button class="btn btn-primary" style="margin-top: 12px;" onclick="saveRouters()">💾 Guardar Conteo de Routers</button>
                </div>
            </section>

            <section class="audit-section">
                <div class="section-header">
                    <div class="section-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">📝</div>
                    <div class="section-title">Observaciones de la Habitación</div>
                </div>
                <div class="section-content">
                    <textarea class="notes-area" id="generalNotes" placeholder="Escribir observaciones adicionales..."></textarea>
                </div>
            </section>

            <div class="action-bar">
                <button class="btn btn-primary" onclick="exportToCSV()">📥 Exportar CSV</button>
                <button class="btn btn-info" onclick="switchTab('reports')">📊 Ver Reportes</button>
                <button class="btn" onclick="window.print()">🖨️ Imprimir</button>
                <button class="btn btn-danger" onclick="clearAllData()" data-permission="clearAll">🗑️ Limpiar Todo</button>
            </div>

            <div class="progress-section">
                <h3>📊 Progreso de Auditoría</h3>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%">0%</div>
                </div>
                <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-muted);">
                    <span><span id="auditedCount">0</span> auditadas</span>
                    <span><span id="pendingCount">204</span> pendientes</span>
                </div>
                <div class="legend">
                    <div class="legend-item"><div class="legend-dot sencilla"></div> Sencilla</div>
                    <div class="legend-item"><div class="legend-dot doble"></div> Doble</div>
                    <div class="legend-item"><div class="legend-dot" style="background: var(--accent-pink);"></div> Suite</div>
                    <div class="legend-item"><div class="legend-dot presidencial"></div> Presidencial</div>
                    <div class="legend-item"><div class="legend-dot audited"></div> Auditada</div>
                    <div class="legend-item"><div class="legend-dot issues"></div> Con Incidencias</div>
                </div>
            </div>
        </div>

        <!-- TAB 2: REPORTES -->
        <div id="reports-tab" class="tab-content">
            <div class="dashboard-header">
                <h2>📊 Dashboard de Reportes</h2>
                <div class="dashboard-actions no-print">
                    <button class="btn" onclick="refreshCharts()">🔄 Actualizar</button>
                    <button class="btn btn-primary" onclick="window.print()">🖨️ Imprimir Reporte</button>
                </div>
            </div>

            <div class="executive-summary">
                <h2>📋 Resumen Ejecutivo</h2>
                <div class="exec-grid">
                    <div class="exec-item">
                        <h4>Estado General</h4>
                        <p>Se han auditado <span class="highlight green" id="exec-audited">0</span> de <span class="highlight">204</span> habitaciones (<span class="highlight" id="exec-percent">0%</span>)</p>
                    </div>
                    <div class="exec-item">
                        <h4>Incidencias Detectadas</h4>
                        <p>Total: <span class="highlight red" id="exec-issues">0</span> | Habitaciones afectadas: <span class="highlight yellow" id="exec-rooms-issues">0</span></p>
                    </div>
                    <div class="exec-item">
                        <h4>Telefonía</h4>
                        <p>Teléfonos de buró faltantes: <span class="highlight yellow" id="exec-phones">0</span></p>
                    </div>
                    <div class="exec-item">
                        <h4>Infraestructura de Red</h4>
                        <p>Routers: <span class="highlight" id="exec-routers">0</span> / 42</p>
                    </div>
                </div>
            </div>

            <div class="kpi-grid">
                <div class="kpi-card green">
                    <div class="kpi-icon">✅</div>
                    <div class="kpi-value" id="kpi-completed">0%</div>
                    <div class="kpi-label">Avance</div>
                    <div class="kpi-sublabel" id="kpi-completed-sub">0 de 204</div>
                </div>
                <div class="kpi-card red">
                    <div class="kpi-icon">⚠️</div>
                    <div class="kpi-value" id="kpi-issues">0</div>
                    <div class="kpi-label">Incidencias</div>
                    <div class="kpi-sublabel" id="kpi-issues-sub">En 0 habitaciones</div>
                </div>
                <div class="kpi-card yellow">
                    <div class="kpi-icon">📺</div>
                    <div class="kpi-value" id="kpi-tv">0</div>
                    <div class="kpi-label">Fallas TV</div>
                </div>
                <div class="kpi-card blue">
                    <div class="kpi-icon">📞</div>
                    <div class="kpi-value" id="kpi-phone">0</div>
                    <div class="kpi-label">Fallas Tel.</div>
                </div>
                <div class="kpi-card purple">
                    <div class="kpi-icon">🌐</div>
                    <div class="kpi-value" id="kpi-network">0</div>
                    <div class="kpi-label">Fallas Red</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h3>📈 Progreso por Piso</h3>
                    <div class="chart-container"><canvas id="chartFloorProgress"></canvas></div>
                </div>
                <div class="chart-card">
                    <h3>🍩 Distribución de Incidencias</h3>
                    <div class="chart-container"><canvas id="chartIssuesDistribution"></canvas></div>
                </div>
            </div>

            <!-- Mapa de Calor de Cobertura WiFi -->
            <div class="data-table-container wifi-heatmap-container">
                <h3>📶 Mapa de Calor - Cobertura WiFi</h3>
                <div class="heatmap-legend">
                    <span class="legend-item"><span class="legend-color alta"></span> Alta</span>
                    <span class="legend-item"><span class="legend-color media"></span> Media</span>
                    <span class="legend-item"><span class="legend-color baja"></span> Baja</span>
                    <span class="legend-item"><span class="legend-color sin-datos"></span> Sin datos</span>
                    <span class="legend-item"><span class="legend-color necesita-router"></span> 🔴 Necesita Router</span>
                </div>
                <div class="heatmap-stats" id="wifiStats">
                    <div class="wifi-stat"><span class="stat-value green" id="wifi-alta">0</span><span class="stat-label">Alta</span></div>
                    <div class="wifi-stat"><span class="stat-value yellow" id="wifi-media">0</span><span class="stat-label">Media</span></div>
                    <div class="wifi-stat"><span class="stat-value red" id="wifi-baja">0</span><span class="stat-label">Baja</span></div>
                    <div class="wifi-stat"><span class="stat-value" id="wifi-pending">0</span><span class="stat-label">Pendientes</span></div>
                </div>
                <div class="heatmap-grid" id="wifiHeatmap"></div>
                <div class="heatmap-rooms-needing-router">
                    <h4>🚨 Habitaciones que necesitan Router (Cobertura Baja/Media)</h4>
                    <div id="roomsNeedingRouter" class="rooms-router-list">Sin datos aún</div>
                </div>
            </div>

            <!-- Inventario de Pantallas -->
            <div class="data-table-container tv-inventory-container">
                <h3>📺 Inventario de Pantallas para Dirección</h3>
                <div class="tv-inventory-summary" id="tvInventorySummary">
                    <div class="tv-stat-card">
                        <div class="tv-stat-icon">📺</div>
                        <div class="tv-stat-value" id="tv-total-audited">0</div>
                        <div class="tv-stat-label">Pantallas Auditadas</div>
                    </div>
                    <div class="tv-stat-card hd-yes">
                        <div class="tv-stat-icon">✅</div>
                        <div class="tv-stat-value" id="tv-hd-yes">0</div>
                        <div class="tv-stat-label">Soportan HD</div>
                    </div>
                    <div class="tv-stat-card hd-no">
                        <div class="tv-stat-icon">⚠️</div>
                        <div class="tv-stat-value" id="tv-hd-no">0</div>
                        <div class="tv-stat-label">NO Soportan HD</div>
                    </div>
                    <div class="tv-stat-card pending">
                        <div class="tv-stat-icon">❓</div>
                        <div class="tv-stat-value" id="tv-hd-pending">0</div>
                        <div class="tv-stat-label">Sin Registrar</div>
                    </div>
                </div>
                
                <h4 style="margin: 20px 0 12px; color: var(--text-secondary);">📏 Distribución por Pulgadas</h4>
                <div class="inches-distribution" id="inchesDistribution">
                    <p style="color: var(--text-muted);">Sin datos de pulgadas registrados</p>
                </div>
                
                <h4 style="margin: 20px 0 12px; color: var(--text-secondary);">🚨 Pantallas que Requieren Cambio (No soportan HD)</h4>
                <div class="tv-needs-upgrade" id="tvNeedsUpgrade">
                    <p style="color: var(--text-muted);">No hay pantallas identificadas que requieran cambio</p>
                </div>
                
                <div class="tv-recommendation" id="tvRecommendation" style="display: none;">
                    <h4>💡 Recomendación para Dirección</h4>
                    <p id="tvRecommendationText"></p>
                </div>
            </div>

            <!-- Reporte de Teléfonos Panasonic -->
            <div class="data-table-container panasonic-report-container">
                <h3>📞 Reporte de Teléfonos Panasonic (No Estándar)</h3>
                <div class="panasonic-summary">
                    <div class="panasonic-stat-card standard">
                        <div class="panasonic-stat-icon">✅</div>
                        <div class="panasonic-stat-value" id="phone-standard">0</div>
                        <div class="panasonic-stat-label">Teléfonos Estándar</div>
                    </div>
                    <div class="panasonic-stat-card panasonic">
                        <div class="panasonic-stat-icon">⚠️</div>
                        <div class="panasonic-stat-value" id="phone-panasonic-count">0</div>
                        <div class="panasonic-stat-label">Teléfonos Panasonic</div>
                    </div>
                    <div class="panasonic-stat-card pending">
                        <div class="panasonic-stat-icon">❓</div>
                        <div class="panasonic-stat-value" id="phone-type-pending">0</div>
                        <div class="panasonic-stat-label">Sin Registrar</div>
                    </div>
                </div>
                
                <h4 style="margin: 20px 0 12px; color: var(--text-secondary);">🚨 Habitaciones con Teléfono Panasonic</h4>
                <div class="panasonic-rooms-list" id="panasonicRoomsList">
                    <p style="color: var(--text-muted);">No hay habitaciones con teléfono Panasonic identificadas</p>
                </div>
                
                <div class="panasonic-recommendation" id="panasonicRecommendation" style="display: none;">
                    <h4>💡 Recomendación para Dirección</h4>
                    <p id="panasonicRecommendationText"></p>
                </div>
            </div>

            <div class="data-table-container">
                <h3>📋 Comparativa por Piso</h3>
                <table class="data-table">
                    <thead>
                        <tr><th>Piso</th><th>Total</th><th>Auditadas</th><th>Pendientes</th><th>Incidencias</th><th>% Completado</th></tr>
                    </thead>
                    <tbody id="floorComparisonTable"></tbody>
                </table>
            </div>

            <div class="data-table-container">
                <h3>🔴 Detalle de Incidencias</h3>
                <div class="issues-list" id="issuesDetailList">
                    <p style="color: var(--text-muted); text-align: center; padding: 20px;">No hay incidencias registradas</p>
                </div>
            </div>

            <!-- NUEVO: Reportes por Tipo de Falla -->
            <div class="data-table-container failure-report-container">
                <h3>📊 Reportes por Tipo de Falla</h3>
                <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.85rem;">
                    Selecciona un tipo de falla para ver el listado de habitaciones afectadas
                </p>
                
                <div class="failure-type-selector">
                    <label style="color: var(--text-secondary); font-size: 0.85rem; margin-right: 10px;">Tipo de Falla:</label>
                    <select id="failureTypeSelect" class="failure-select" onchange="generateFailureReport()">
                        <option value="">-- Seleccionar tipo de falla --</option>
                        <optgroup label="📺 TV Principal">
                            <option value="screen-power">TV Principal - No enciende</option>
                            <option value="screen-remote">TV Principal - Control remoto no funciona</option>
                            <option value="screen-image">TV Principal - Problemas de imagen</option>
                            <option value="tv1-no-hd">TV Principal - No soporta HD</option>
                        </optgroup>
                        <optgroup label="📺 TV Secundaria (Suite/Presidencial)">
                            <option value="screen2-power">TV Secundaria - No enciende</option>
                            <option value="screen2-remote">TV Secundaria - Control remoto no funciona</option>
                            <option value="screen2-image">TV Secundaria - Problemas de imagen</option>
                            <option value="tv2-no-hd">TV Secundaria - No soporta HD</option>
                        </optgroup>
                        <optgroup label="📺 Canales de TV">
                            <option value="channels-fail">Canales con falla</option>
                        </optgroup>
                        <optgroup label="📞 Teléfono">
                            <option value="phone-ring">Teléfono - No suena</option>
                            <option value="phone-dial">Teléfono - No marca</option>
                            <option value="phone-display">Teléfono - Display apagado</option>
                            <option value="phone-panasonic">Teléfono Panasonic (no estándar)</option>
                        </optgroup>
                        <optgroup label="🌐 Red / WiFi">
                            <option value="wifi-baja">WiFi - Cobertura baja</option>
                            <option value="wifi-media">WiFi - Cobertura media</option>
                            <option value="router-needed">Necesita Router</option>
                        </optgroup>
                    </select>
                </div>

                <div id="failureReportResult" class="failure-report-result">
                    <p style="color: var(--text-muted); text-align: center; padding: 30px;">
                        Selecciona un tipo de falla para generar el reporte
                    </p>
                </div>

                <div id="failureReportActions" class="failure-report-actions" style="display: none;">
                    <button class="action-btn" onclick="copyFailureReport()">📋 Copiar Reporte</button>
                    <button class="action-btn" onclick="printFailureReport()">🖨️ Imprimir</button>
                    <button class="action-btn" onclick="exportFailureReportCSV()">📥 Exportar CSV</button>
                </div>
            </div>

            <!-- NUEVO: Reportes por Piso -->
            <div class="data-table-container floor-report-container">
                <h3>🏢 Reportes por Piso</h3>
                <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.85rem;">
                    Selecciona un piso para ver todas las incidencias detectadas - ideal para presentar a Dirección
                </p>
                
                <div class="floor-selector-grid">
                    <button class="floor-select-btn" onclick="generateFloorReport(1)">
                        <span class="floor-number">1</span>
                        <span class="floor-label">Piso 1</span>
                        <span class="floor-issues-count" id="floor-1-issues">0 incidencias</span>
                    </button>
                    <button class="floor-select-btn" onclick="generateFloorReport(2)">
                        <span class="floor-number">2</span>
                        <span class="floor-label">Piso 2</span>
                        <span class="floor-issues-count" id="floor-2-issues">0 incidencias</span>
                    </button>
                    <button class="floor-select-btn" onclick="generateFloorReport(3)">
                        <span class="floor-number">3</span>
                        <span class="floor-label">Piso 3</span>
                        <span class="floor-issues-count" id="floor-3-issues">0 incidencias</span>
                    </button>
                    <button class="floor-select-btn" onclick="generateFloorReport(4)">
                        <span class="floor-number">4</span>
                        <span class="floor-label">Piso 4</span>
                        <span class="floor-issues-count" id="floor-4-issues">0 incidencias</span>
                    </button>
                    <button class="floor-select-btn" onclick="generateFloorReport(5)">
                        <span class="floor-number">5</span>
                        <span class="floor-label">Piso 5</span>
                        <span class="floor-issues-count" id="floor-5-issues">0 incidencias</span>
                    </button>
                </div>

                <div id="floorReportResult" class="floor-report-result">
                    <p style="color: var(--text-muted); text-align: center; padding: 30px;">
                        Selecciona un piso para generar el reporte detallado
                    </p>
                </div>

                <div id="floorReportActions" class="floor-report-actions" style="display: none;">
                    <button class="action-btn" onclick="copyFloorReport()">📋 Copiar Reporte</button>
                    <button class="action-btn" onclick="printFloorReport()">🖨️ Imprimir</button>
                    <button class="action-btn" onclick="exportFloorReportCSV()">📥 Exportar CSV</button>
                </div>
            </div>

            <!-- Resumen de Todas las Fallas -->
            <div class="data-table-container all-failures-summary">
                <h3>📋 Resumen General de Fallas</h3>
                <div id="allFailuresSummary" class="all-failures-grid">
                    <p style="color: var(--text-muted); text-align: center; padding: 20px;">
                        Completa auditorías para ver el resumen de fallas
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // LOGO DEL HOTEL
        // ============================================
        const HOTEL_LOGO = 'data:image/webp;base64,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';
        
        // Función para cargar logos
        function initLogos() {
            // Logo en pantalla de login
            const loginLogo = document.getElementById('loginLogoImg');
            if (loginLogo) {
                loginLogo.src = HOTEL_LOGO;
            }
            // Logos en headers de la app
            const headerLogos = document.querySelectorAll('.header-logo-img');
            headerLogos.forEach(img => {
                img.src = HOTEL_LOGO;
            });
        }
        
        // ============================================
        // SISTEMA DE AUTENTICACIÓN
        // ============================================
        
        // Niveles de usuario
        const USER_LEVELS = {
            'admin': { name: 'Super Admin', canDelete: true, canClearAll: true, canEditAny: true },
            'advanced': { name: 'Auditor Avanzado', canDelete: false, canClearAll: false, canEditAny: true },
            'basic': { name: 'Auditor', canDelete: false, canClearAll: false, canEditAny: false }
        };
        
        // Sesión actual
        let currentUser = null;
        
        // Verificar sesión al cargar
        function checkSession() {
            const savedSession = localStorage.getItem('audit_session');
            if (savedSession) {
                try {
                    const session = JSON.parse(savedSession);
                    // Verificar que la sesión no haya expirado (24 horas)
                    if (session.timestamp && (Date.now() - session.timestamp) < 24 * 60 * 60 * 1000) {
                        currentUser = session;
                        showApp();
                        return true;
                    }
                } catch(e) {
                    console.error('Error parsing session:', e);
                }
            }
            showLogin();
            return false;
        }
        
        // Mostrar pantalla de login
        function showLogin() {
            document.getElementById('loginOverlay').classList.remove('hidden');
            document.getElementById('loadingOverlay').style.display = 'none';
        }
        
        // Mostrar aplicación
        async function showApp() {
            document.getElementById('loginOverlay').classList.add('hidden');
            updateUserBadge();
            applyPermissions();
            loadSavedSettings();
            
            // Poner el nombre del usuario en el campo de auditor
            const auditorField = document.getElementById('auditorName');
            if (auditorField && currentUser) {
                auditorField.value = currentUser.displayName || currentUser.username;
            }
            
            // Continuar con la inicialización si hay API_URL
            if (!API_URL) {
                document.getElementById('configPanel').classList.add('show');
                document.getElementById('loadingOverlay').classList.add('hidden');
            } else {
                await syncData();
            }
            
            if (ALL_ROOMS.length > 0) loadRoom(ALL_ROOMS[0]);
            
            // Iniciar auto-sync (evitar múltiples intervalos)
            if (syncIntervalId) clearInterval(syncIntervalId);
            syncIntervalId = setInterval(syncData, 30000);
        }
        
        // Actualizar badge de usuario
        function updateUserBadge() {
            if (!currentUser) return;
            
            const badge = document.getElementById('userBadge');
            const icon = document.getElementById('userIcon');
            const name = document.getElementById('userName');
            const role = document.getElementById('userRole');
            
            // Iniciales del usuario
            const initials = currentUser.username.substring(0, 2).toUpperCase();
            icon.textContent = initials;
            name.textContent = currentUser.displayName || currentUser.username;
            role.textContent = USER_LEVELS[currentUser.level]?.name || 'Usuario';
            
            // Clase según nivel
            badge.classList.remove('admin', 'advanced');
            if (currentUser.level === 'admin') badge.classList.add('admin');
            else if (currentUser.level === 'advanced') badge.classList.add('advanced');
        }
        
        // Aplicar permisos según nivel
        function applyPermissions() {
            if (!currentUser) return;
            
            const perms = USER_LEVELS[currentUser.level] || USER_LEVELS['basic'];
            
            // Elementos que requieren permisos especiales
            const deleteElements = document.querySelectorAll('[data-permission="delete"]');
            const clearAllElements = document.querySelectorAll('[data-permission="clearAll"]');
            const editElements = document.querySelectorAll('[data-permission="editAny"]');
            
            deleteElements.forEach(el => {
                if (!perms.canDelete) el.classList.add('permission-hidden');
                else el.classList.remove('permission-hidden');
            });
            
            clearAllElements.forEach(el => {
                if (!perms.canClearAll) el.classList.add('permission-hidden');
                else el.classList.remove('permission-hidden');
            });
        }
        
        // Manejar login
        async function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('loginUsername').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');
            const loginBtn = document.getElementById('loginBtn');
            
            errorEl.classList.remove('show');
            loginBtn.disabled = true;
            loginBtn.textContent = 'Verificando...';
            
            try {
                const apiUrl = localStorage.getItem('auditApiUrl');
                if (!apiUrl) {
                    // Si no hay API URL, mostrar la app para configurarla
                    currentUser = { username: 'config', level: 'admin', displayName: 'Configuración' };
                    localStorage.setItem('audit_session', JSON.stringify({ ...currentUser, timestamp: Date.now() }));
                    showApp();
                    return;
                }
                
                // Verificar credenciales contra Google Sheets
                const response = await fetch(`${apiUrl}?action=verifyLogin&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`);
                const result = await response.json();
                
                if (result.success && result.user) {
                    currentUser = {
                        username: result.user.username,
                        level: result.user.level,
                        displayName: result.user.displayName,
                        timestamp: Date.now()
                    };
                    localStorage.setItem('audit_session', JSON.stringify(currentUser));
                    showApp();
                    syncData(); // Sincronizar al iniciar sesión
                } else {
                    errorEl.textContent = result.message || 'Usuario o contraseña incorrectos';
                    errorEl.classList.add('show');
                }
            } catch(e) {
                console.error('Login error:', e);
                errorEl.textContent = 'Error de conexión. Verifica tu internet.';
                errorEl.classList.add('show');
            } finally {
                loginBtn.disabled = false;
                loginBtn.textContent = 'Iniciar Sesión';
            }
        }
        
        // Cerrar sesión
        function handleLogout() {
            if (confirm('¿Deseas cerrar sesión?')) {
                localStorage.removeItem('audit_session');
                currentUser = null;
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                showLogin();
            }
        }
        
        // Verificar permiso antes de acciones
        function hasPermission(action) {
            if (!currentUser) return false;
            const perms = USER_LEVELS[currentUser.level] || USER_LEVELS['basic'];
            return perms[action] === true;
        }
        
        // ============================================
        // CONFIGURACIÓN
        // ============================================
        
        const HOTEL_ROOMS = {
            1: [101,102,103,104,105,106,107,108,109,110,111,112,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142],
            2: [201,202,203,204,205,206,207,208,209,210,211,212,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242],
            3: [301,302,303,304,305,306,307,308,309,310,311,312,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342],
            4: [401,402,403,404,405,406,407,408,409,410,411,412,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442],
            5: [501,502,503,504,505,506,507,508,509,510,511,512,514,515,516,517,518,519,520,521,522,523,524,525,526,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542]
        };

        const DOUBLE_ROOMS = [107,110,111,112,117,126,129,132,135,138,141,142,204,207,210,212,217,226,229,232,235,238,304,307,310,312,317,326,329,332,335,338,404,407,410,412,417,426,429,432,435,438,504,507,510,512,517,526,529,532,535,538];
        const SUITE_ROOMS = [116,127,216,227,316,327,416,427,516];
        const PRESIDENTIAL_ROOM = 528;
        const TWO_TV_ROOMS = [...SUITE_ROOMS, PRESIDENTIAL_ROOM]; // Habitaciones con 2 pantallas
        const ALL_ROOMS = Object.values(HOTEL_ROOMS).flat();
        const TOTAL_ROOMS = ALL_ROOMS.length;
        const CHANNELS_START = 5, CHANNELS_END = 63, STARTUP_CHANNEL = 62;

        // Mapa de nombres de canales
        const CHANNEL_NAMES = {
            5: 'Azteca 7', 6: 'Azteca 1', 7: 'Estelar', 8: 'Canal 5', 9: 'FX',
            10: 'TBS', 11: 'Telemundo', 12: 'Unicable', 14: 'E!', 15: 'Comedy',
            16: 'AXN', 17: 'Sony Ch', 18: 'Warner', 19: 'TNT', 20: 'Sony Movies',
            21: 'NFL', 22: 'ESPN HD', 23: 'ESPN2 HD', 24: 'ESPN 3', 25: 'TUDN',
            26: 'Fox Sports HD', 27: 'Fox Sports 2', 28: 'Fox Sports 3', 29: 'Telefórmula',
            30: 'Milenio', 31: 'Financiero', 32: 'CNN Español', 33: 'CNN HD',
            34: 'HLN', 35: 'Fox News', 36: 'BBC', 37: 'Disney Jr', 38: 'Disney Kids',
            39: 'Disney Ch', 40: 'Cartoon Net', 41: 'Discovery', 42: 'History',
            43: 'Nat Geo', 44: 'Nick', 45: 'Telehit', 46: 'MTV Hits', 47: 'MTV 00s',
            48: 'A&E', 49: 'TLC', 50: 'Universal', 51: 'HBO POP', 52: 'Fox Channel',
            53: 'Space', 54: 'HBO XTREME', 56: 'HBO', 57: 'HBO 2', 58: 'HBO Signature',
            59: 'HBO Family', 60: 'HBO Plus', 61: 'HBO Mundo', 62: 'BONVOY', 63: 'ROOM SERVICE'
        };

        // Canales que requieren HD (tienen versión HD)
        const HD_CHANNELS = [22, 23, 24, 26, 27, 33, 51, 54, 56, 57, 58, 59, 60, 61];

        // Canales que NO existen en el hotel
        const EXCLUDED_CHANNELS = [13, 55];

        let auditData = {};
        let currentRoom = '';
        let currentFloor = 1;
        let routerTotalCount = 0;
        let API_URL = localStorage.getItem('auditApiUrl') || '';
        let isConnected = false;
        let charts = {};

        // ============================================
        // INICIALIZACIÓN
        // ============================================
        
        let syncIntervalId = null;

        document.addEventListener('DOMContentLoaded', async function() {
            initLogos(); // Cargar logos del hotel
            setCurrentDate();
            generateFloorTabs();
            generateChannelGrid();
            generateRoomGrid(1);
            
            // Verificar sesión primero
            checkSession();
        });

        function saveApiUrl() {
            const url = document.getElementById('apiUrlInput').value.trim();
            if (url) {
                API_URL = url;
                localStorage.setItem('auditApiUrl', url);
                document.getElementById('configPanel').classList.remove('show');
                syncData();
            }
        }

        function setCurrentDate() {
            const now = new Date();
            document.getElementById('currentDate').textContent = now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        }

        function loadSavedSettings() {
            const auditorField = document.getElementById('auditorName');
            
            // Usar el nombre del usuario loggeado
            if (currentUser) {
                auditorField.value = currentUser.displayName || currentUser.username;
                
                // Solo admin puede cambiar el nombre del auditor
                if (currentUser.level !== 'admin') {
                    auditorField.readOnly = true;
                    auditorField.style.opacity = '0.7';
                    auditorField.title = 'Solo el administrador puede cambiar este campo';
                }
            } else {
                const savedAuditor = localStorage.getItem('auditorName');
                if (savedAuditor) auditorField.value = savedAuditor;
            }
            
            auditorField.addEventListener('change', function() {
                if (currentUser && currentUser.level === 'admin') {
                    localStorage.setItem('auditorName', this.value);
                }
            });
        }

        // ============================================
        // HISTORIAL DE HABITACIONES
        // ============================================

        async function showHistory() {
            const roomNum = document.getElementById('roomNumber').value;
            if (!roomNum) {
                showToast('Selecciona una habitación primero', 'warning');
                return;
            }

            document.getElementById('historyRoomNumber').textContent = roomNum;
            document.getElementById('historyModal').style.display = 'flex';
            document.getElementById('historyContent').innerHTML = '<p style="text-align: center; color: var(--text-muted);">Cargando historial...</p>';

            try {
                const response = await fetch(`${API_URL}?action=getHistory&room=${roomNum}`);
                const result = await response.json();

                if (result.success) {
                    renderHistory(result.history, roomNum);
                } else {
                    document.getElementById('historyContent').innerHTML = '<p style="text-align: center; color: var(--accent-danger);">Error al cargar historial</p>';
                }
            } catch (error) {
                console.error('Error loading history:', error);
                document.getElementById('historyContent').innerHTML = '<p style="text-align: center; color: var(--accent-danger);">Error de conexión</p>';
            }
        }

        function renderHistory(history, roomNum) {
            const container = document.getElementById('historyContent');
            
            if (history.length === 0) {
                container.innerHTML = `<p style="text-align: center; color: var(--text-muted);">No hay historial para la habitación ${roomNum}</p>`;
                return;
            }

            // Calcular estadísticas
            const totalAudits = history.length;
            const auditsWithIssues = history.filter(h => h.issueCount > 0).length;
            const totalIssues = history.reduce((sum, h) => sum + (h.issueCount || 0), 0);
            const issueRate = totalAudits > 0 ? Math.round((auditsWithIssues / totalAudits) * 100) : 0;

            // Detectar fallas recurrentes
            const failureCategories = {};
            history.forEach(h => {
                if (h.screen?.['screen-power'] === 'fail') failureCategories['TV Principal - Encendido'] = (failureCategories['TV Principal - Encendido'] || 0) + 1;
                if (h.screen?.['screen-remote'] === 'fail') failureCategories['TV Principal - Control'] = (failureCategories['TV Principal - Control'] || 0) + 1;
                if (h.screen?.['screen-image'] === 'fail') failureCategories['TV Principal - Imagen'] = (failureCategories['TV Principal - Imagen'] || 0) + 1;
                if (h.screen2?.['screen2-power'] === 'fail') failureCategories['TV Secundaria - Encendido'] = (failureCategories['TV Secundaria - Encendido'] || 0) + 1;
                if (h.screen2?.['screen2-remote'] === 'fail') failureCategories['TV Secundaria - Control'] = (failureCategories['TV Secundaria - Control'] || 0) + 1;
                if (h.screen2?.['screen2-image'] === 'fail') failureCategories['TV Secundaria - Imagen'] = (failureCategories['TV Secundaria - Imagen'] || 0) + 1;
                if (h.channels?.startup === 'fail') failureCategories['Canal de inicio'] = (failureCategories['Canal de inicio'] || 0) + 1;
                (h.failedChannels || h.channels?.failed || []).forEach(ch => {
                    failureCategories[`Canal ${ch}`] = (failureCategories[`Canal ${ch}`] || 0) + 1;
                });
                if (h.phone?.['phone-desk'] === 'fail') failureCategories['Teléfono escritorio'] = (failureCategories['Teléfono escritorio'] || 0) + 1;
                if (h.phone?.['phone-nightstand'] === 'fail') failureCategories['Teléfono buró'] = (failureCategories['Teléfono buró'] || 0) + 1;
                if (h.phone?.['phone-battery'] === 'fail') failureCategories['Batería auriculares'] = (failureCategories['Batería auriculares'] || 0) + 1;
                if (h.phone?.['phone-condition'] === 'fail') failureCategories['Condición teléfono'] = (failureCategories['Condición teléfono'] || 0) + 1;
                if (h.network?.['network-wall'] === 'fail') failureCategories['Nodo de pared'] = (failureCategories['Nodo de pared'] || 0) + 1;
                if (h.network?.['network-connection'] === 'fail') failureCategories['Conexión de red'] = (failureCategories['Conexión de red'] || 0) + 1;
                if (h.network?.['network-speed'] === 'fail') failureCategories['Velocidad de red'] = (failureCategories['Velocidad de red'] || 0) + 1;
            });

            // Ordenar fallas por frecuencia
            const sortedFailures = Object.entries(failureCategories).sort((a, b) => b[1] - a[1]);
            const recurrentIssues = sortedFailures.filter(([_, count]) => count >= 2);

            let html = `
                <div class="history-summary">
                    <h4>📊 Resumen de Historial - Habitación ${roomNum}</h4>
                    <div class="history-stats">
                        <div class="history-stat">
                            <div class="history-stat-value">${totalAudits}</div>
                            <div class="history-stat-label">Auditorías</div>
                        </div>
                        <div class="history-stat">
                            <div class="history-stat-value ${auditsWithIssues > 0 ? 'red' : 'green'}">${auditsWithIssues}</div>
                            <div class="history-stat-label">Con Incidencias</div>
                        </div>
                        <div class="history-stat">
                            <div class="history-stat-value ${totalIssues > 0 ? 'yellow' : 'green'}">${totalIssues}</div>
                            <div class="history-stat-label">Total Fallas</div>
                        </div>
                        <div class="history-stat">
                            <div class="history-stat-value ${issueRate > 30 ? 'red' : issueRate > 10 ? 'yellow' : 'green'}">${issueRate}%</div>
                            <div class="history-stat-label">Tasa de Fallas</div>
                        </div>
                    </div>
                    ${recurrentIssues.length > 0 ? `
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-color);">
                            <h4 style="color: var(--accent-danger); margin-bottom: 8px;">⚠️ Fallas Recurrentes Detectadas:</h4>
                            <ul style="margin: 0; padding-left: 20px; color: var(--text-secondary);">
                                ${recurrentIssues.map(([name, count]) => `<li><strong>${name}</strong>: ${count} veces</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                </div>
            `;

            // Renderizar cada auditoría
            history.forEach((audit, index) => {
                const hasIssues = audit.issueCount > 0;
                const issues = [];
                
                // Recopilar detalles de fallas
                if (audit.screen?.['screen-power'] === 'fail') issues.push('TV Principal no enciende');
                if (audit.screen?.['screen-remote'] === 'fail') issues.push('Control remoto falla');
                if (audit.screen?.['screen-image'] === 'fail') issues.push('Calidad de imagen deficiente');
                if (audit.screen2?.['screen2-power'] === 'fail') issues.push('TV Secundaria no enciende');
                if (audit.screen2?.['screen2-remote'] === 'fail') issues.push('Control remoto 2 falla');
                if (audit.screen2?.['screen2-image'] === 'fail') issues.push('Calidad de imagen TV2 deficiente');
                if (audit.channels?.startup === 'fail') issues.push('No inicia en canal 62');
                const failedChs = audit.failedChannels || audit.channels?.failed || [];
                if (failedChs.length > 0) issues.push(`Canales fallando: ${failedChs.join(', ')}`);
                if (audit.phone?.['phone-desk'] === 'fail') issues.push('Teléfono de escritorio falla');
                if (audit.phone?.['phone-nightstand'] === 'fail') issues.push('Teléfono de buró falla');
                if (audit.phone?.['phone-battery'] === 'fail') issues.push('Batería de auriculares falla');
                if (audit.phone?.['phone-condition'] === 'fail') issues.push('Condición física del teléfono');
                if (audit.network?.['network-wall'] === 'fail') issues.push('Nodo de pared falla');
                if (audit.network?.['network-connection'] === 'fail') issues.push('Sin conexión de red');
                if (audit.network?.['network-speed'] === 'fail') issues.push('Velocidad de red baja');

                html += `
                    <div class="history-item ${hasIssues ? 'has-issues' : 'no-issues'}">
                        <div class="history-header">
                            <div>
                                <div class="history-date">${audit.fecha || 'Sin fecha'}</div>
                                <div class="history-auditor">Auditó: <strong>${audit.auditor || 'Sin nombre'}</strong> | Turno: ${audit.shift || '-'}</div>
                            </div>
                            <div class="history-issues ${hasIssues ? 'danger' : 'success'}">
                                ${hasIssues ? `⚠️ ${audit.issueCount} incidencias` : '✓ Sin incidencias'}
                            </div>
                        </div>
                        ${issues.length > 0 ? `
                            <div class="history-details">
                                <strong>Fallas detectadas:</strong>
                                <ul>
                                    ${issues.map(issue => `<li>${issue}</li>`).join('')}
                                </ul>
                            </div>
                        ` : ''}
                        ${audit.notes ? `<div class="history-notes">📝 "${audit.notes}"</div>` : ''}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function closeHistoryModal() {
            document.getElementById('historyModal').style.display = 'none';
        }

        // Cerrar modal al hacer clic fuera
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('historyModal');
            if (e.target === modal) {
                closeHistoryModal();
            }
        });

        // ============================================
        // SINCRONIZACIÓN CON LA NUBE
        // ============================================

        async function syncData() {
            if (!API_URL) return;
            
            const syncBtn = document.getElementById('syncBtn');
            const statusDot = document.getElementById('statusDot');
            const connectionText = document.getElementById('connectionText');
            
            syncBtn.classList.add('syncing');
            statusDot.className = 'status-dot syncing';
            connectionText.textContent = 'Sincronizando...';

            try {
                const response = await fetch(`${API_URL}?action=getAll`);
                const result = await response.json();
                
                if (result.success) {
                    auditData = result.data || {};
                    routerTotalCount = result.routers?.count || 0;
                    
                    if (result.routers?.notes) {
                        document.getElementById('routerNotes').value = result.routers.notes;
                    }
                    
                    isConnected = true;
                    statusDot.className = 'status-dot connected';
                    connectionText.textContent = 'Conectado a la nube';
                    document.getElementById('lastSync').textContent = ` • Última sync: ${new Date().toLocaleTimeString('es-MX')}`;
                    
                    updateSummary();
                    updateProgress();
                    updateFloorPendingCounts();
                    updateRouterDisplay();
                    generateRoomGrid(currentFloor);
                    
                    showToast('Datos sincronizados correctamente', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('Error syncing:', error);
                isConnected = false;
                statusDot.className = 'status-dot disconnected';
                connectionText.textContent = 'Sin conexión';
                showToast('Error al sincronizar: ' + error.message, 'error');
            } finally {
                syncBtn.classList.remove('syncing');
                document.getElementById('loadingOverlay').classList.add('hidden');
            }
        }

        async function saveToCloud(roomData) {
            if (!API_URL) {
                showToast('No hay conexión configurada', 'error');
                return false;
            }

            try {
                // Usar GET con datos codificados para evitar problemas de CORS
                const params = new URLSearchParams({
                    action: 'saveRoom',
                    data: JSON.stringify(roomData)
                });
                
                const response = await fetch(`${API_URL}?${params.toString()}`);
                const result = await response.json();
                return result.success;
            } catch (error) {
                console.error('Error saving:', error);
                showToast('Error de conexión: ' + error.message, 'error');
                return false;
            }
        }

        async function saveRoutersToCloud() {
            if (!API_URL) {
                showToast('No hay conexión configurada', 'error');
                return false;
            }

            try {
                const routerData = {
                    count: routerTotalCount,
                    notes: document.getElementById('routerNotes').value,
                    auditor: document.getElementById('auditorName').value
                };
                
                const params = new URLSearchParams({
                    action: 'saveRouters',
                    data: JSON.stringify(routerData)
                });
                
                const response = await fetch(`${API_URL}?${params.toString()}`);
                const result = await response.json();
                return result.success;
            } catch (error) {
                console.error('Error saving routers:', error);
                showToast('Error de conexión: ' + error.message, 'error');
                return false;
            }
        }

        // ============================================
        // TOAST NOTIFICATIONS
        // ============================================

        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<span>${type === 'success' ? '✅' : type === 'error' ? '❌' : '⚠️'}</span> ${message}`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        // ============================================
        // FUNCIONES DE UI
        // ============================================

        function switchTab(tabName) {
            document.querySelectorAll('.main-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            if (tabName === 'reports') refreshCharts();
        }

        function getRoomType(roomNum) {
            const num = parseInt(roomNum);
            if (num === PRESIDENTIAL_ROOM) return 'presidencial';
            if (SUITE_ROOMS.includes(num)) return 'suite';
            if (DOUBLE_ROOMS.includes(num)) return 'doble';
            return 'sencilla';
        }

        function getRoomTypeLabel(type) {
            return { 'sencilla': 'Sencilla', 'doble': 'Doble', 'suite': '⭐ Suite', 'presidencial': '👑 Presidencial' }[type] || type;
        }

        function hasTwoTVs(roomNum) {
            return TWO_TV_ROOMS.includes(parseInt(roomNum));
        }

        function generateFloorTabs() {
            const container = document.getElementById('floorTabs');
            container.innerHTML = '';
            for (let floor = 1; floor <= 5; floor++) {
                const tab = document.createElement('button');
                tab.className = 'floor-tab' + (floor === 1 ? ' active' : '');
                tab.id = `floor-tab-${floor}`;
                
                const floorRooms = HOTEL_ROOMS[floor] || [];
                const pending = floorRooms.filter(r => !auditData[r]).length;
                
                tab.innerHTML = `Piso ${floor} <span class="floor-pending" id="floor-pending-${floor}">${pending}</span>`;
                tab.onclick = () => selectFloor(floor);
                container.appendChild(tab);
            }
        }
        
        function updateFloorPendingCounts() {
            for (let floor = 1; floor <= 5; floor++) {
                const floorRooms = HOTEL_ROOMS[floor] || [];
                const pending = floorRooms.filter(r => !auditData[r]).length;
                const badge = document.getElementById(`floor-pending-${floor}`);
                if (badge) {
                    badge.textContent = pending;
                    badge.classList.toggle('complete', pending === 0);
                }
            }
        }

        function selectFloor(floor) {
            currentFloor = floor;
            document.querySelectorAll('.floor-tab').forEach((tab, i) => tab.classList.toggle('active', i + 1 === floor));
            generateRoomGrid(floor);
        }

        function generateRoomGrid(floor) {
            const container = document.getElementById('roomGrid');
            container.innerHTML = '';
            const rooms = HOTEL_ROOMS[floor] || [];
            const filter = document.getElementById('filterType').value;
            
            rooms.forEach(roomNum => {
                const type = getRoomType(roomNum);
                const data = auditData[roomNum];
                const isAudited = !!data;
                const hasIssues = data && data.issueCount > 0;
                const isCurrent = currentRoom == roomNum;
                
                if (filter) {
                    if (filter === 'pending' && isAudited) return;
                    if (filter === 'audited' && !isAudited) return;
                    if (filter === 'issues' && !hasIssues) return;
                    if (['sencilla', 'doble', 'suite', 'presidencial'].includes(filter) && type !== filter) return;
                }
                
                const btn = document.createElement('button');
                btn.className = `room-btn ${type}`;
                if (isAudited) btn.classList.add(hasIssues ? 'has-issues' : 'audited');
                if (isCurrent) btn.classList.add('current');
                btn.textContent = roomNum;
                btn.onclick = () => loadRoom(roomNum);
                container.appendChild(btn);
            });
        }

        function filterRooms() { generateRoomGrid(currentFloor); }

        function generateChannelGrid() {
            const grid = document.getElementById('channelGrid');
            grid.innerHTML = '';
            for (let i = CHANNELS_START; i <= CHANNELS_END; i++) {
                // Saltar canales que no existen
                if (EXCLUDED_CHANNELS.includes(i)) continue;
                
                const btn = document.createElement('button');
                const isHD = HD_CHANNELS.includes(i);
                btn.className = 'channel-btn' + (i === STARTUP_CHANNEL ? ' start' : '') + (isHD ? ' hd-channel' : '');
                btn.innerHTML = `<span class="ch-num">${i}</span><span class="ch-name">${CHANNEL_NAMES[i] || ''}</span>${isHD ? '<span class="hd-badge">HD</span>' : ''}`;
                btn.dataset.channel = i;
                btn.title = CHANNEL_NAMES[i] || `Canal ${i}`;
                btn.onclick = function() { toggleChannel(this); };
                grid.appendChild(btn);
            }
        }

        function toggleChannel(btn) {
            if (btn.classList.contains('checked')) {
                btn.classList.remove('checked');
                btn.classList.add('failed');
            } else if (btn.classList.contains('failed')) {
                btn.classList.remove('failed');
            } else {
                btn.classList.add('checked');
            }
            updateSectionStatus('channels');
        }

        // Función para establecer soporte HD de TV
        function setTVHD(tvNum, supportsHD) {
            const yesBtn = document.getElementById(`tv${tvNum}-hd-yes`);
            const noBtn = document.getElementById(`tv${tvNum}-hd-no`);
            const container = document.getElementById(`tv${tvNum}-hd-item`);
            
            yesBtn.classList.remove('active');
            noBtn.classList.remove('active');
            container.classList.remove('checked');
            
            if (supportsHD) {
                yesBtn.classList.add('active');
            } else {
                noBtn.classList.add('active');
            }
            container.classList.add('checked');
            updateSectionStatus('screen');
        }

        function onTVSpecChange(tvNum, field) {
            if (field === 'inches') {
                const select = document.getElementById(`tv${tvNum}-inches`);
                const container = document.getElementById(`tv${tvNum}-inches-item`);
                
                container.classList.remove('checked');
                if (select.value) {
                    container.classList.add('checked');
                }
                updateSectionStatus('screen');
            }
        }

        function setCheck(id, status) {
            const item = document.getElementById(id);
            item.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            item.classList.remove('checked', 'failed', 'na', 'coverage-low', 'coverage-med', 'coverage-high', 'panasonic-yes', 'panasonic-no');
            
            if (status === 'ok') {
                item.classList.add('checked');
                item.querySelector('.toggle-btn.ok').classList.add('active');
            } else if (status === 'fail') {
                item.classList.add('failed');
                item.querySelector('.toggle-btn.fail').classList.add('active');
            } else if (status === 'na') {
                item.classList.add('na');
                item.querySelector('.toggle-btn.na').classList.add('active');
            } else if (status === 'baja') {
                item.classList.add('coverage-low', 'failed');
                item.querySelector('.toggle-btn.coverage-low').classList.add('active');
            } else if (status === 'media') {
                item.classList.add('coverage-med', 'checked');
                item.querySelector('.toggle-btn.coverage-med').classList.add('active');
            } else if (status === 'alta') {
                item.classList.add('coverage-high', 'checked');
                item.querySelector('.toggle-btn.coverage-high').classList.add('active');
            } else if (status === 'si') {
                item.classList.add('panasonic-yes', 'checked');
                item.querySelector('.toggle-btn.panasonic-yes').classList.add('active');
            } else if (status === 'no') {
                item.classList.add('panasonic-no', 'checked');
                item.querySelector('.toggle-btn.panasonic-no').classList.add('active');
            }

            const section = item.closest('.audit-section');
            const sectionId = section.querySelector('.section-content').id.replace('-content', '');
            updateSectionStatus(sectionId);
        }

        function updateSectionStatus(sectionId) {
            const content = document.getElementById(sectionId + '-content');
            const statusEl = document.getElementById(sectionId + '-status');
            const items = content.querySelectorAll('.check-item');
            let total = 0, completed = 0, hasErrors = false;

            items.forEach(item => {
                // Solo contar items visibles (verificar si está dentro de second-tv-section oculto)
                const secondTVSection = item.closest('#second-tv-section');
                if (secondTVSection && secondTVSection.style.display === 'none') return;
                
                total++;
                if (item.classList.contains('checked') || item.classList.contains('na')) completed++;
                else if (item.classList.contains('failed')) { completed++; hasErrors = true; }
            });

            if (sectionId === 'channels') {
                const channelBtns = content.querySelectorAll('.channel-btn');
                let channelTotal = channelBtns.length, channelCompleted = 0;
                channelBtns.forEach(btn => {
                    if (btn.classList.contains('checked') || btn.classList.contains('failed')) {
                        channelCompleted++;
                        if (btn.classList.contains('failed')) hasErrors = true;
                    }
                });
                
                if (channelCompleted === channelTotal && completed === total) {
                    statusEl.textContent = hasErrors ? 'Con fallas' : 'Completo';
                    statusEl.className = 'section-status ' + (hasErrors ? 'error' : 'complete');
                } else {
                    statusEl.textContent = `${channelCompleted + completed}/${channelTotal + total}`;
                    statusEl.className = 'section-status incomplete';
                }
                return;
            }

            if (completed === total && total > 0) {
                statusEl.textContent = hasErrors ? 'Con fallas' : 'Completo';
                statusEl.className = 'section-status ' + (hasErrors ? 'error' : 'complete');
            } else if (completed > 0) {
                statusEl.textContent = `${completed}/${total}`;
                statusEl.className = 'section-status incomplete';
            } else {
                statusEl.textContent = 'Pendiente';
                statusEl.className = 'section-status';
            }
        }

        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId + '-content');
            content.style.display = content.style.display === 'none' ? 'block' : 'none';
        }

        function updateRouterCount(delta) {
            routerTotalCount = Math.max(0, routerTotalCount + delta);
            updateRouterDisplay();
        }

        function updateRouterDisplay() {
            document.getElementById('routerCounterValue').textContent = routerTotalCount;
            document.getElementById('routerCount').textContent = routerTotalCount;
            const statusEl = document.getElementById('routerStatus');
            const diff = 42 - routerTotalCount;
            
            if (routerTotalCount === 42) {
                statusEl.textContent = '✓ Conteo completo - 42 routers';
                statusEl.className = 'counter-status ok';
            } else {
                statusEl.textContent = diff > 0 ? `⚠ Faltan ${diff} routers` : `⚠ ${Math.abs(diff)} de más`;
                statusEl.className = 'counter-status warning';
            }
        }

        async function saveRouters() {
            const btn = document.querySelector('[onclick="saveRouters()"]');
            btn.disabled = true;
            btn.textContent = '⏳ Guardando...';
            
            const success = await saveRoutersToCloud();
            
            btn.disabled = false;
            btn.textContent = '💾 Guardar Conteo de Routers';
            
            if (success) {
                showToast('Conteo de routers guardado en la nube', 'success');
            } else {
                showToast('Error al guardar routers', 'error');
            }
        }

        // ============================================
        // ROOM DATA
        // ============================================

        function getRoomData() {
            const roomNum = document.getElementById('roomNumber').value;
            const failedChannels = [];
            document.querySelectorAll('.channel-btn.failed').forEach(btn => failedChannels.push(btn.dataset.channel));
            
            let issueCount = 0;
            
            // Contar fallas en TV principal
            ['screen-power', 'screen-remote', 'screen-image'].forEach(id => {
                if (document.getElementById(id).classList.contains('failed')) issueCount++;
            });
            
            // Contar fallas en TV secundaria (si aplica)
            const screen2Data = {};
            if (hasTwoTVs(roomNum)) {
                ['screen2-power', 'screen2-remote', 'screen2-image'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el.classList.contains('checked')) screen2Data[id] = 'ok';
                    else if (el.classList.contains('failed')) { screen2Data[id] = 'fail'; issueCount++; }
                });
                // Agregar especificaciones de TV2
                screen2Data.inches = document.getElementById('tv2-inches').value || '';
                screen2Data.supportsHD = document.getElementById('tv2-hd-yes').classList.contains('active') ? 'si' : 
                                        document.getElementById('tv2-hd-no').classList.contains('active') ? 'no' : '';
            }
            
            if (document.getElementById('channel-startup').classList.contains('failed')) issueCount++;
            issueCount += failedChannels.length;
            ['phone-desk', 'phone-nightstand', 'phone-battery', 'phone-condition', 'network-wall', 'network-connection', 'network-speed'].forEach(id => {
                if (document.getElementById(id).classList.contains('failed')) issueCount++;
            });
            
            // Contar cobertura baja como issue
            if (document.getElementById('wifi-coverage').classList.contains('coverage-low')) issueCount++;

            const getStatus = (id) => {
                const el = document.getElementById(id);
                if (el.classList.contains('coverage-low')) return 'baja';
                if (el.classList.contains('coverage-med')) return 'media';
                if (el.classList.contains('coverage-high')) return 'alta';
                if (el.classList.contains('panasonic-yes')) return 'si';
                if (el.classList.contains('panasonic-no')) return 'no';
                return el.classList.contains('checked') ? 'ok' : el.classList.contains('failed') ? 'fail' : el.classList.contains('na') ? 'na' : '';
            };
            
            // Obtener especificaciones de TV1
            const tv1Inches = document.getElementById('tv1-inches').value || '';
            const tv1HD = document.getElementById('tv1-hd-yes').classList.contains('active') ? 'si' : 
                         document.getElementById('tv1-hd-no').classList.contains('active') ? 'no' : '';

            const data = {
                room: roomNum,
                roomType: getRoomType(roomNum),
                auditor: document.getElementById('auditorName').value,
                shift: document.getElementById('shift').value,
                screen: { 
                    'screen-power': getStatus('screen-power'), 
                    'screen-remote': getStatus('screen-remote'), 
                    'screen-image': getStatus('screen-image'),
                    'tv1-inches': tv1Inches,
                    'tv1-hd': tv1HD
                },
                channels: { startup: getStatus('channel-startup') },
                failedChannels,
                phone: { 
                    'phone-desk': getStatus('phone-desk'), 
                    'phone-nightstand': getStatus('phone-nightstand'), 
                    'phone-battery': getStatus('phone-battery'), 
                    'phone-condition': getStatus('phone-condition'),
                    'phone-panasonic': getStatus('phone-panasonic')
                },
                network: { 'network-wall': getStatus('network-wall'), 'network-connection': getStatus('network-connection'), 'network-speed': getStatus('network-speed'), 'wifi-coverage': getStatus('wifi-coverage') },
                issueCount,
                notes: document.getElementById('generalNotes').value
            };
            
            // Agregar datos de segunda TV si aplica
            if (hasTwoTVs(roomNum)) {
                data.screen2 = screen2Data;
            }
            
            return data;
        }

        async function saveRoom() {
            const roomNum = document.getElementById('roomNumber').value;
            if (!roomNum || !ALL_ROOMS.includes(parseInt(roomNum))) {
                showToast('Número de habitación inválido', 'error');
                return;
            }

            if (!document.getElementById('auditorName').value) {
                showToast('Por favor ingresa tu nombre', 'warning');
                return;
            }

            const btn = document.getElementById('saveBtn');
            btn.disabled = true;
            btn.textContent = '⏳ Guardando...';

            const data = getRoomData();
            const success = await saveToCloud(data);

            btn.disabled = false;
            btn.textContent = '💾 Guardar en Nube';

            if (success) {
                auditData[roomNum] = data;
                updateSummary();
                updateProgress();
                updateFloorPendingCounts();
                generateRoomGrid(currentFloor);
                showToast(`Habitación ${roomNum} guardada por ${data.auditor}`, 'success');
            } else {
                showToast('Error al guardar. Verifica tu conexión.', 'error');
            }
        }

        function loadRoom(roomNum) {
            currentRoom = roomNum;
            document.getElementById('roomNumber').value = roomNum;
            
            const type = getRoomType(roomNum);
            const badge = document.getElementById('roomTypeBadge');
            badge.textContent = getRoomTypeLabel(type);
            badge.className = 'room-type-badge ' + type;
            
            // Mostrar/ocultar segunda TV para Suite y Presidencial
            const secondTVSection = document.getElementById('second-tv-section');
            if (hasTwoTVs(roomNum)) {
                secondTVSection.style.display = 'block';
            } else {
                secondTVSection.style.display = 'none';
            }
            
            const floor = Math.floor(parseInt(roomNum) / 100);
            if (floor !== currentFloor) selectFloor(floor);
            else generateRoomGrid(floor);
            
            clearRoomState();
            
            const data = auditData[roomNum];
            if (data) {
                document.getElementById('generalNotes').value = data.notes || '';
                
                // Cargar checks de TV principal
                Object.keys(data.screen || {}).forEach(id => { 
                    if (data.screen[id] && id.startsWith('screen-')) setCheck(id, data.screen[id]); 
                });
                
                // Cargar especificaciones de TV1
                if (data.screen?.['tv1-inches']) {
                    document.getElementById('tv1-inches').value = data.screen['tv1-inches'];
                    document.getElementById('tv1-inches-item').classList.add('checked');
                }
                if (data.screen?.['tv1-hd'] === 'si') {
                    setTVHD(1, true);
                } else if (data.screen?.['tv1-hd'] === 'no') {
                    setTVHD(1, false);
                }
                
                // Cargar datos de segunda TV si existen
                if (data.screen2) {
                    Object.keys(data.screen2).forEach(id => { 
                        if (data.screen2[id] && id.startsWith('screen2-')) setCheck(id, data.screen2[id]); 
                    });
                    // Especificaciones de TV2
                    if (data.screen2.inches) {
                        document.getElementById('tv2-inches').value = data.screen2.inches;
                        document.getElementById('tv2-inches-item').classList.add('checked');
                    }
                    if (data.screen2.supportsHD === 'si') {
                        setTVHD(2, true);
                    } else if (data.screen2.supportsHD === 'no') {
                        setTVHD(2, false);
                    }
                }
                
                if (data.channels?.startup) setCheck('channel-startup', data.channels.startup);
                
                // Si la habitación ya fue auditada, marcar TODOS los canales como OK (verde)
                // y luego marcar solo los fallidos en rojo
                const failedChannels = data.failedChannels || data.channels?.failed || [];
                document.querySelectorAll('.channel-btn').forEach(btn => {
                    const ch = btn.dataset.channel;
                    if (failedChannels.includes(ch) || failedChannels.includes(parseInt(ch))) {
                        btn.classList.add('failed');
                    } else {
                        btn.classList.add('checked'); // Canal funciona OK
                    }
                });

                Object.keys(data.phone || {}).forEach(id => { if (data.phone[id]) setCheck(id, data.phone[id]); });
                Object.keys(data.network || {}).forEach(id => { if (data.network[id]) setCheck(id, data.network[id]); });

                ['screen', 'channels', 'phone', 'network'].forEach(updateSectionStatus);
            }
        }

        function loadRoomByInput() {
            const roomNum = parseInt(document.getElementById('roomNumber').value);
            if (ALL_ROOMS.includes(roomNum)) loadRoom(roomNum);
        }

        function clearRoomState() {
            document.querySelectorAll('.check-item').forEach(item => {
                item.classList.remove('checked', 'failed', 'na', 'coverage-low', 'coverage-med', 'coverage-high', 'panasonic-yes', 'panasonic-no');
                item.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            });
            document.querySelectorAll('.channel-btn').forEach(btn => btn.classList.remove('checked', 'failed'));
            document.getElementById('generalNotes').value = '';
            
            // Limpiar especificaciones de TV
            document.getElementById('tv1-inches').value = '';
            document.getElementById('tv2-inches').value = '';
            ['tv1-hd-yes', 'tv1-hd-no', 'tv2-hd-yes', 'tv2-hd-no'].forEach(id => {
                document.getElementById(id).classList.remove('active');
            });
            
            ['screen', 'channels', 'phone', 'network'].forEach(s => {
                const el = document.getElementById(s + '-status');
                if (el) { el.textContent = 'Pendiente'; el.className = 'section-status'; }
            });
        }

        function clearRoom() { clearRoomState(); }
        function previousRoom() { const idx = ALL_ROOMS.indexOf(parseInt(currentRoom)); if (idx > 0) loadRoom(ALL_ROOMS[idx - 1]); }
        function nextRoom() { const idx = ALL_ROOMS.indexOf(parseInt(currentRoom)); if (idx < ALL_ROOMS.length - 1) loadRoom(ALL_ROOMS[idx + 1]); }

        function updateSummary() {
            const rooms = Object.keys(auditData);
            let totalIssues = 0, phoneMissing = 0;
            rooms.forEach(room => {
                const data = auditData[room];
                totalIssues += data.issueCount || 0;
                if (data.phone?.['phone-nightstand'] === 'na') phoneMissing++;
            });
            document.getElementById('roomsAudited').textContent = rooms.length;
            document.getElementById('roomsPending').textContent = TOTAL_ROOMS - rooms.length;
            document.getElementById('issuesFound').textContent = totalIssues;
            document.getElementById('phoneMissing').textContent = phoneMissing;
        }

        function updateProgress() {
            const audited = Object.keys(auditData).length;
            const percent = Math.round((audited / TOTAL_ROOMS) * 100);
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressBar').textContent = percent + '%';
            document.getElementById('auditedCount').textContent = audited;
            document.getElementById('pendingCount').textContent = TOTAL_ROOMS - audited;
        }

        // ============================================
        // REPORTES
        // ============================================

        function refreshCharts() {
            const rooms = Object.keys(auditData);
            let totalIssues = 0, roomsWithIssues = 0, phoneMissing = 0, tvIssues = 0, phoneIssues = 0, networkIssues = 0;
            const floorStats = {1:{t:41,a:0,i:0},2:{t:41,a:0,i:0},3:{t:41,a:0,i:0},4:{t:41,a:0,i:0},5:{t:40,a:0,i:0}};
            const issuesByCategory = { 'Pantalla': 0, 'Canales': 0, 'Telefonía': 0, 'Red': 0 };

            rooms.forEach(room => {
                const data = auditData[room];
                const floor = Math.floor(parseInt(room) / 100);
                if (floorStats[floor]) floorStats[floor].a++;
                
                if (data.phone?.['phone-nightstand'] === 'na') phoneMissing++;
                
                const issues = data.issueCount || 0;
                if (issues > 0) {
                    roomsWithIssues++;
                    if (floorStats[floor]) floorStats[floor].i++;
                    totalIssues += issues;
                    
                    // Count by category
                    ['screen-power','screen-remote','screen-image'].forEach(k => { if(data.screen?.[k]==='fail') { tvIssues++; issuesByCategory['Pantalla']++; }});
                    if(data.channels?.startup==='fail') { tvIssues++; issuesByCategory['Canales']++; }
                    (data.failedChannels||[]).forEach(() => { tvIssues++; issuesByCategory['Canales']++; });
                    ['phone-desk','phone-nightstand','phone-battery','phone-condition'].forEach(k => { if(data.phone?.[k]==='fail') { phoneIssues++; issuesByCategory['Telefonía']++; }});
                    ['network-wall','network-connection','network-speed'].forEach(k => { if(data.network?.[k]==='fail') { networkIssues++; issuesByCategory['Red']++; }});
                }
            });

            const percent = Math.round((rooms.length / TOTAL_ROOMS) * 100);

            // Update KPIs
            document.getElementById('exec-audited').textContent = rooms.length;
            document.getElementById('exec-percent').textContent = percent + '%';
            document.getElementById('exec-issues').textContent = totalIssues;
            document.getElementById('exec-rooms-issues').textContent = roomsWithIssues;
            document.getElementById('exec-phones').textContent = phoneMissing;
            document.getElementById('exec-routers').textContent = routerTotalCount;
            document.getElementById('kpi-completed').textContent = percent + '%';
            document.getElementById('kpi-completed-sub').textContent = `${rooms.length} de ${TOTAL_ROOMS}`;
            document.getElementById('kpi-issues').textContent = totalIssues;
            document.getElementById('kpi-issues-sub').textContent = `En ${roomsWithIssues} habitaciones`;
            document.getElementById('kpi-tv').textContent = tvIssues;
            document.getElementById('kpi-phone').textContent = phoneIssues;
            document.getElementById('kpi-network').textContent = networkIssues;

            // Floor table
            const tableBody = document.getElementById('floorComparisonTable');
            tableBody.innerHTML = '';
            for (let f = 1; f <= 5; f++) {
                const fs = floorStats[f];
                const pct = Math.round((fs.a / fs.t) * 100);
                tableBody.innerHTML += `<tr><td><strong>Piso ${f}</strong></td><td>${fs.t}</td><td>${fs.a}</td><td>${fs.t - fs.a}</td><td>${fs.i}</td><td>${pct}%</td></tr>`;
            }

            // Issues list
            const issuesList = document.getElementById('issuesDetailList');
            const roomsWithIssuesList = rooms.filter(r => auditData[r].issueCount > 0).sort((a,b) => parseInt(a) - parseInt(b));
            
            if (roomsWithIssuesList.length === 0) {
                issuesList.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 20px;">No hay incidencias registradas</p>';
            } else {
                issuesList.innerHTML = '';
                roomsWithIssuesList.forEach(room => {
                    const data = auditData[room];
                    const issues = [];
                    ['screen-power','screen-remote','screen-image'].forEach(k => { if(data.screen?.[k]==='fail') issues.push(`Pantalla: ${k.replace('screen-','')}`); });
                    if(data.channels?.startup==='fail') issues.push('Canales: No inicia en 62');
                    (data.failedChannels||[]).forEach(ch => issues.push(`Canal ${ch}`));
                    ['phone-desk','phone-nightstand','phone-battery','phone-condition'].forEach(k => { if(data.phone?.[k]==='fail') issues.push(`Telefonía: ${k.replace('phone-','')}`); });
                    ['network-wall','network-connection','network-speed'].forEach(k => { if(data.network?.[k]==='fail') issues.push(`Red: ${k.replace('network-','')}`); });
                    
                    issues.forEach(issue => {
                        issuesList.innerHTML += `<div class="issue-row"><span class="issue-room">${room}</span><span class="issue-type">${getRoomTypeLabel(data.roomType)}</span><span class="issue-detail">${issue}</span><span style="font-size:0.75rem;color:var(--text-muted);">${data.auditor || ''}</span></div>`;
                    });
                });
            }

            // Charts
            Object.values(charts).forEach(c => c.destroy());
            charts = {};

            const ctxFloor = document.getElementById('chartFloorProgress').getContext('2d');
            charts.floor = new Chart(ctxFloor, {
                type: 'bar',
                data: {
                    labels: ['Piso 1', 'Piso 2', 'Piso 3', 'Piso 4', 'Piso 5'],
                    datasets: [
                        { label: 'Auditadas', data: [1,2,3,4,5].map(f => floorStats[f].a), backgroundColor: '#10b981' },
                        { label: 'Pendientes', data: [1,2,3,4,5].map(f => floorStats[f].t - floorStats[f].a), backgroundColor: '#64748b' },
                        { label: 'Con Incidencias', data: [1,2,3,4,5].map(f => floorStats[f].i), backgroundColor: '#ef4444' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: '#94a3b8' }}}, scales: { x: { ticks: { color: '#94a3b8' }, grid: { color: '#2d3a50' }}, y: { ticks: { color: '#94a3b8' }, grid: { color: '#2d3a50' }}}}
            });

            const ctxIssues = document.getElementById('chartIssuesDistribution').getContext('2d');
            charts.issues = new Chart(ctxIssues, {
                type: 'doughnut',
                data: {
                    labels: ['Pantalla', 'Canales', 'Telefonía', 'Red'],
                    datasets: [{ data: [issuesByCategory['Pantalla'], issuesByCategory['Canales'], issuesByCategory['Telefonía'], issuesByCategory['Red']], backgroundColor: ['#6366f1', '#f59e0b', '#ec4899', '#3b82f6'] }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8' }}}}
            });
            
            // Generate WiFi Heatmap
            generateWifiHeatmap();
            
            // Generate TV Inventory Report
            generateTVInventory();
            
            // Generate Panasonic Phone Report
            generatePanasonicReport();
            
            // Generate All Failures Summary
            updateAllFailuresSummary();
        }

        function generateWifiHeatmap() {
            const heatmapContainer = document.getElementById('wifiHeatmap');
            const roomsNeedingRouterContainer = document.getElementById('roomsNeedingRouter');
            
            let wifiStats = { alta: 0, media: 0, baja: 0, pending: 0 };
            let roomsNeedingRouter = [];
            
            heatmapContainer.innerHTML = '';
            
            // Generate heatmap by floor
            for (let floor = 1; floor <= 5; floor++) {
                const floorDiv = document.createElement('div');
                floorDiv.className = 'heatmap-floor';
                
                const label = document.createElement('div');
                label.className = 'heatmap-floor-label';
                label.textContent = `Piso ${floor}`;
                floorDiv.appendChild(label);
                
                const roomsDiv = document.createElement('div');
                roomsDiv.className = 'heatmap-rooms';
                
                HOTEL_ROOMS[floor].forEach(roomNum => {
                    const roomDiv = document.createElement('div');
                    roomDiv.className = 'heatmap-room';
                    roomDiv.textContent = roomNum.toString().slice(-2);
                    roomDiv.title = `Habitación ${roomNum}`;
                    roomDiv.onclick = () => { switchTab('audit'); loadRoom(roomNum); };
                    
                    const data = auditData[roomNum];
                    const coverage = data?.network?.['wifi-coverage'];
                    
                    if (coverage === 'alta') {
                        roomDiv.classList.add('alta');
                        wifiStats.alta++;
                    } else if (coverage === 'media') {
                        roomDiv.classList.add('media');
                        wifiStats.media++;
                        roomsNeedingRouter.push({ room: roomNum, coverage: 'media' });
                    } else if (coverage === 'baja') {
                        roomDiv.classList.add('baja');
                        wifiStats.baja++;
                        roomsNeedingRouter.push({ room: roomNum, coverage: 'baja' });
                    } else {
                        wifiStats.pending++;
                    }
                    
                    roomsDiv.appendChild(roomDiv);
                });
                
                floorDiv.appendChild(roomsDiv);
                heatmapContainer.appendChild(floorDiv);
            }
            
            // Update stats
            document.getElementById('wifi-alta').textContent = wifiStats.alta;
            document.getElementById('wifi-media').textContent = wifiStats.media;
            document.getElementById('wifi-baja').textContent = wifiStats.baja;
            document.getElementById('wifi-pending').textContent = wifiStats.pending;
            
            // Update rooms needing router list
            if (roomsNeedingRouter.length === 0) {
                roomsNeedingRouterContainer.innerHTML = '<span style="color: var(--text-muted);">No hay habitaciones con cobertura baja/media detectadas aún</span>';
            } else {
                // Sort by coverage (baja first) then by room number
                roomsNeedingRouter.sort((a, b) => {
                    if (a.coverage === 'baja' && b.coverage !== 'baja') return -1;
                    if (a.coverage !== 'baja' && b.coverage === 'baja') return 1;
                    return a.room - b.room;
                });
                
                roomsNeedingRouterContainer.innerHTML = roomsNeedingRouter.map(r => 
                    `<span class="router-needed-room ${r.coverage}">${r.room} (${r.coverage === 'baja' ? '🔴' : '🟡'})</span>`
                ).join('');
            }
        }

        function generateTVInventory() {
            const rooms = Object.keys(auditData);
            
            let stats = {
                totalAudited: 0,
                hdYes: 0,
                hdNo: 0,
                hdPending: 0,
                inches: {}
            };
            
            let roomsNeedingUpgrade = [];
            
            rooms.forEach(room => {
                const data = auditData[room];
                
                // Contar TV1
                if (data.screen) {
                    stats.totalAudited++;
                    
                    const hd = data.screen['tv1-hd'];
                    if (hd === 'si') {
                        stats.hdYes++;
                    } else if (hd === 'no') {
                        stats.hdNo++;
                        roomsNeedingUpgrade.push({
                            room: room,
                            inches: data.screen['tv1-inches'] || '?',
                            tv: 'Principal'
                        });
                    } else {
                        stats.hdPending++;
                    }
                    
                    // Contar pulgadas
                    const inches = data.screen['tv1-inches'];
                    if (inches) {
                        stats.inches[inches] = (stats.inches[inches] || 0) + 1;
                    }
                }
                
                // Contar TV2 si existe
                if (data.screen2 && (data.screen2['screen2-power'] || data.screen2.inches || data.screen2.supportsHD)) {
                    stats.totalAudited++;
                    
                    const hd2 = data.screen2.supportsHD;
                    if (hd2 === 'si') {
                        stats.hdYes++;
                    } else if (hd2 === 'no') {
                        stats.hdNo++;
                        roomsNeedingUpgrade.push({
                            room: room,
                            inches: data.screen2.inches || '?',
                            tv: 'Secundaria'
                        });
                    } else {
                        stats.hdPending++;
                    }
                    
                    // Contar pulgadas TV2
                    if (data.screen2.inches) {
                        stats.inches[data.screen2.inches] = (stats.inches[data.screen2.inches] || 0) + 1;
                    }
                }
            });
            
            // Update stats display
            document.getElementById('tv-total-audited').textContent = stats.totalAudited;
            document.getElementById('tv-hd-yes').textContent = stats.hdYes;
            document.getElementById('tv-hd-no').textContent = stats.hdNo;
            document.getElementById('tv-hd-pending').textContent = stats.hdPending;
            
            // Generate inches distribution
            const inchesContainer = document.getElementById('inchesDistribution');
            const inchesKeys = Object.keys(stats.inches).sort((a, b) => parseInt(a) - parseInt(b));
            
            if (inchesKeys.length === 0) {
                inchesContainer.innerHTML = '<p style="color: var(--text-muted);">Sin datos de pulgadas registrados</p>';
            } else {
                inchesContainer.innerHTML = inchesKeys.map(inch => `
                    <div class="inches-bar">
                        <span class="inches-label">${inch}"</span>
                        <span class="inches-count">${stats.inches[inch]} TV${stats.inches[inch] > 1 ? 's' : ''}</span>
                    </div>
                `).join('');
            }
            
            // Generate rooms needing upgrade list
            const upgradeContainer = document.getElementById('tvNeedsUpgrade');
            if (roomsNeedingUpgrade.length === 0) {
                upgradeContainer.innerHTML = '<p style="color: var(--text-muted);">No hay pantallas identificadas que requieran cambio</p>';
            } else {
                roomsNeedingUpgrade.sort((a, b) => parseInt(a.room) - parseInt(b.room));
                upgradeContainer.innerHTML = roomsNeedingUpgrade.map(r => `
                    <span class="tv-upgrade-room">
                        ${r.room}${r.tv === 'Secundaria' ? ' (TV2)' : ''}
                        <span class="room-inches">${r.inches !== '?' ? r.inches + '"' : ''}</span>
                    </span>
                `).join('');
            }
            
            // Generate recommendation
            const recContainer = document.getElementById('tvRecommendation');
            const recText = document.getElementById('tvRecommendationText');
            
            if (stats.hdNo > 0) {
                recContainer.style.display = 'block';
                const percentage = Math.round((stats.hdNo / stats.totalAudited) * 100);
                const hdChannelsCount = HD_CHANNELS.length;
                
                recText.innerHTML = `
                    Se identificaron <strong>${stats.hdNo} pantallas (${percentage}%)</strong> que NO soportan resolución HD.<br><br>
                    El hotel cuenta con <strong>${hdChannelsCount} canales en HD</strong> (ESPN HD, CNN HD, HBO, Fox Sports HD, etc.) 
                    que los huéspedes no pueden visualizar correctamente en estas pantallas.<br><br>
                    <strong>Recomendación:</strong> Reemplazar las ${stats.hdNo} pantallas identificadas por modelos LED de al menos 43" 
                    con soporte Full HD (1080p) para garantizar la experiencia del huésped con la programación premium del hotel.
                `;
            } else if (stats.totalAudited > 0 && stats.hdPending === 0) {
                recContainer.style.display = 'block';
                recText.innerHTML = `
                    ✅ <strong>Excelente:</strong> Todas las pantallas auditadas (${stats.hdYes}) soportan resolución HD 
                    y pueden mostrar correctamente los ${HD_CHANNELS.length} canales HD del hotel.
                `;
            } else {
                recContainer.style.display = 'none';
            }
        }

        function generatePanasonicReport() {
            const rooms = Object.keys(auditData);
            
            let stats = {
                standard: 0,
                panasonic: 0,
                pending: 0
            };
            
            let panasonicRooms = [];
            
            rooms.forEach(room => {
                const data = auditData[room];
                const phonePanasonic = data.phone?.['phone-panasonic'];
                
                if (phonePanasonic === 'si') {
                    stats.panasonic++;
                    panasonicRooms.push(room);
                } else if (phonePanasonic === 'no') {
                    stats.standard++;
                } else {
                    stats.pending++;
                }
            });
            
            // Update stats display
            document.getElementById('phone-standard').textContent = stats.standard;
            document.getElementById('phone-panasonic-count').textContent = stats.panasonic;
            document.getElementById('phone-type-pending').textContent = stats.pending;
            
            // Generate panasonic rooms list
            const listContainer = document.getElementById('panasonicRoomsList');
            if (panasonicRooms.length === 0) {
                listContainer.innerHTML = '<p style="color: var(--text-muted);">No hay habitaciones con teléfono Panasonic identificadas</p>';
            } else {
                panasonicRooms.sort((a, b) => parseInt(a) - parseInt(b));
                listContainer.innerHTML = panasonicRooms.map(room => 
                    `<span class="panasonic-room-badge">${room}</span>`
                ).join('');
            }
            
            // Generate recommendation
            const recContainer = document.getElementById('panasonicRecommendation');
            const recText = document.getElementById('panasonicRecommendationText');
            
            if (stats.panasonic > 0) {
                recContainer.style.display = 'block';
                const total = stats.standard + stats.panasonic;
                const percentage = Math.round((stats.panasonic / total) * 100);
                
                recText.innerHTML = `
                    Se identificaron <strong>${stats.panasonic} habitaciones (${percentage}%)</strong> con teléfonos Panasonic 
                    que no corresponden al estándar del hotel.<br><br>
                    Estos equipos afectan la imagen corporativa y pueden presentar incompatibilidades con el sistema 
                    de telefonía del hotel.<br><br>
                    <strong>Recomendación:</strong> Solicitar presupuesto para adquirir ${stats.panasonic} teléfonos 
                    del modelo estándar del hotel para reemplazar los equipos Panasonic y mantener la uniformidad 
                    en todas las habitaciones.
                `;
            } else if (stats.standard > 0 && stats.pending === 0) {
                recContainer.style.display = 'block';
                recText.innerHTML = `
                    ✅ <strong>Excelente:</strong> Todas las habitaciones auditadas (${stats.standard}) cuentan con 
                    teléfonos del modelo estándar del hotel.
                `;
            } else {
                recContainer.style.display = 'none';
            }
        }

        // ============================================
        // REPORTES POR TIPO DE FALLA
        // ============================================
        
        const FAILURE_TYPES = {
            'screen-power': { name: 'TV Principal - No enciende', icon: '📺', category: 'tv' },
            'screen-remote': { name: 'TV Principal - Control remoto no funciona', icon: '📺', category: 'tv' },
            'screen-image': { name: 'TV Principal - Problemas de imagen', icon: '📺', category: 'tv' },
            'tv1-no-hd': { name: 'TV Principal - No soporta HD', icon: '📺', category: 'tv' },
            'screen2-power': { name: 'TV Secundaria - No enciende', icon: '📺', category: 'tv2' },
            'screen2-remote': { name: 'TV Secundaria - Control remoto no funciona', icon: '📺', category: 'tv2' },
            'screen2-image': { name: 'TV Secundaria - Problemas de imagen', icon: '📺', category: 'tv2' },
            'tv2-no-hd': { name: 'TV Secundaria - No soporta HD', icon: '📺', category: 'tv2' },
            'channels-fail': { name: 'Canales de TV con falla', icon: '📡', category: 'channels' },
            'phone-ring': { name: 'Teléfono - No suena (escritorio)', icon: '📞', category: 'phone' },
            'phone-dial': { name: 'Teléfono - No marca (buró)', icon: '📞', category: 'phone' },
            'phone-display': { name: 'Teléfono - Display apagado', icon: '📞', category: 'phone' },
            'phone-panasonic': { name: 'Teléfono Panasonic (no estándar)', icon: '📞', category: 'phone' },
            'wifi-baja': { name: 'WiFi - Cobertura baja', icon: '📶', category: 'wifi' },
            'wifi-media': { name: 'WiFi - Cobertura media', icon: '📶', category: 'wifi' },
            'router-needed': { name: 'Necesita Router', icon: '🔴', category: 'wifi' }
        };

        function generateFailureReport() {
            const failureType = document.getElementById('failureTypeSelect').value;
            const resultContainer = document.getElementById('failureReportResult');
            const actionsContainer = document.getElementById('failureReportActions');
            
            if (!failureType) {
                resultContainer.innerHTML = `
                    <p style="color: var(--text-muted); text-align: center; padding: 30px;">
                        Selecciona un tipo de falla para generar el reporte
                    </p>
                `;
                actionsContainer.style.display = 'none';
                return;
            }
            
            const failedRooms = getFailedRoomsByType(failureType);
            const typeInfo = FAILURE_TYPES[failureType];
            
            if (failedRooms.length === 0) {
                resultContainer.innerHTML = `
                    <div class="failure-report-header" style="background: rgba(16, 185, 129, 0.1);">
                        <h4>✅ ${typeInfo.name}</h4>
                        <span class="failure-count-badge" style="background: var(--accent-primary);">0</span>
                    </div>
                    <p style="color: var(--accent-primary); text-align: center; padding: 30px;">
                        ¡Excelente! No hay habitaciones con esta falla registrada.
                    </p>
                `;
                actionsContainer.style.display = 'none';
                return;
            }
            
            // Agrupar por piso
            const byFloor = {};
            failedRooms.forEach(room => {
                const floor = Math.floor(parseInt(room) / 100);
                if (!byFloor[floor]) byFloor[floor] = [];
                byFloor[floor].push(room);
            });
            
            // Generar HTML
            let html = `
                <div class="failure-report-header">
                    <h4>${typeInfo.icon} ${typeInfo.name}</h4>
                    <span class="failure-count-badge">${failedRooms.length}</span>
                </div>
                <div class="failure-by-floor">
            `;
            
            for (let floor = 1; floor <= 5; floor++) {
                if (byFloor[floor] && byFloor[floor].length > 0) {
                    const sortedRooms = byFloor[floor].sort((a, b) => parseInt(a) - parseInt(b));
                    html += `
                        <div class="failure-floor-group">
                            <span class="failure-floor-title">Piso ${floor} (${sortedRooms.length} habitaciones)</span>
                            <div class="failure-floor-rooms">
                                ${sortedRooms.map(room => `<span class="failure-room-badge">${room}</span>`).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            html += `</div>`;
            
            resultContainer.innerHTML = html;
            actionsContainer.style.display = 'flex';
        }

        function getFailedRoomsByType(failureType) {
            const rooms = Object.keys(auditData);
            const failedRooms = [];
            
            rooms.forEach(room => {
                const data = auditData[room];
                let hasFailed = false;
                
                switch(failureType) {
                    case 'screen-power':
                        hasFailed = data.screen?.['screen-power'] === 'fail';
                        break;
                    case 'screen-remote':
                        hasFailed = data.screen?.['screen-remote'] === 'fail';
                        break;
                    case 'screen-image':
                        hasFailed = data.screen?.['screen-image'] === 'fail';
                        break;
                    case 'tv1-no-hd':
                        hasFailed = data.screen?.['tv1-hd'] === 'no';
                        break;
                    case 'screen2-power':
                        hasFailed = data.screen2?.['screen2-power'] === 'fail';
                        break;
                    case 'screen2-remote':
                        hasFailed = data.screen2?.['screen2-remote'] === 'fail';
                        break;
                    case 'screen2-image':
                        hasFailed = data.screen2?.['screen2-image'] === 'fail';
                        break;
                    case 'tv2-no-hd':
                        hasFailed = data.screen2?.supportsHD === 'no';
                        break;
                    case 'channels-fail':
                        hasFailed = (data.failedChannels && data.failedChannels.length > 0) || data.channels?.startup === 'fail';
                        break;
                    case 'phone-ring':
                        hasFailed = data.phone?.['phone-desk'] === 'fail';
                        break;
                    case 'phone-dial':
                        hasFailed = data.phone?.['phone-nightstand'] === 'fail';
                        break;
                    case 'phone-display':
                        hasFailed = data.phone?.['phone-battery'] === 'fail';
                        break;
                    case 'phone-panasonic':
                        hasFailed = data.phone?.['phone-panasonic'] === 'si';
                        break;
                    case 'wifi-baja':
                        hasFailed = data.network?.['wifi-coverage'] === 'baja';
                        break;
                    case 'wifi-media':
                        hasFailed = data.network?.['wifi-coverage'] === 'media';
                        break;
                    case 'router-needed':
                        hasFailed = data.network?.['wifi-coverage'] === 'baja' || data.network?.['wifi-coverage'] === 'media';
                        break;
                }
                
                if (hasFailed) {
                    failedRooms.push(room);
                }
            });
            
            return failedRooms.sort((a, b) => parseInt(a) - parseInt(b));
        }

        function copyFailureReport() {
            const failureType = document.getElementById('failureTypeSelect').value;
            if (!failureType) return;
            
            const failedRooms = getFailedRoomsByType(failureType);
            const typeInfo = FAILURE_TYPES[failureType];
            
            // Agrupar por piso
            const byFloor = {};
            failedRooms.forEach(room => {
                const floor = Math.floor(parseInt(room) / 100);
                if (!byFloor[floor]) byFloor[floor] = [];
                byFloor[floor].push(room);
            });
            
            let text = `REPORTE DE FALLAS - ${typeInfo.name}\n`;
            text += `Fecha: ${new Date().toLocaleDateString('es-MX')}\n`;
            text += `Total de habitaciones: ${failedRooms.length}\n`;
            text += `${'='.repeat(50)}\n\n`;
            
            for (let floor = 1; floor <= 5; floor++) {
                if (byFloor[floor] && byFloor[floor].length > 0) {
                    text += `PISO ${floor} (${byFloor[floor].length} habitaciones):\n`;
                    text += byFloor[floor].sort((a, b) => parseInt(a) - parseInt(b)).join(', ') + '\n\n';
                }
            }
            
            text += `${'='.repeat(50)}\n`;
            text += `Hotel Sheraton Chihuahua Soberano\n`;
            text += `Sistema de Auditoría de Sistemas\n`;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Reporte copiado al portapapeles', 'success');
            }).catch(() => {
                showToast('Error al copiar', 'error');
            });
        }

        function printFailureReport() {
            const failureType = document.getElementById('failureTypeSelect').value;
            if (!failureType) return;
            
            const failedRooms = getFailedRoomsByType(failureType);
            const typeInfo = FAILURE_TYPES[failureType];
            
            // Agrupar por piso
            const byFloor = {};
            failedRooms.forEach(room => {
                const floor = Math.floor(parseInt(room) / 100);
                if (!byFloor[floor]) byFloor[floor] = [];
                byFloor[floor].push(room);
            });
            
            let printContent = `
                <html>
                <head>
                    <title>Reporte de Fallas - ${typeInfo.name}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #333; border-bottom: 2px solid #10b981; padding-bottom: 10px; }
                        .info { background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0; }
                        .floor-section { margin: 20px 0; }
                        .floor-title { background: #3b82f6; color: white; padding: 8px 15px; display: inline-block; border-radius: 3px; }
                        .rooms { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
                        .room { background: #ef4444; color: white; padding: 5px 12px; border-radius: 3px; font-weight: bold; }
                        .footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; font-size: 12px; }
                    </style>
                </head>
                <body>
                    <h1>${typeInfo.icon} ${typeInfo.name}</h1>
                    <div class="info">
                        <strong>Fecha:</strong> ${new Date().toLocaleDateString('es-MX')}<br>
                        <strong>Total de habitaciones afectadas:</strong> ${failedRooms.length}
                    </div>
            `;
            
            for (let floor = 1; floor <= 5; floor++) {
                if (byFloor[floor] && byFloor[floor].length > 0) {
                    printContent += `
                        <div class="floor-section">
                            <span class="floor-title">Piso ${floor} (${byFloor[floor].length})</span>
                            <div class="rooms">
                                ${byFloor[floor].sort((a, b) => parseInt(a) - parseInt(b)).map(r => `<span class="room">${r}</span>`).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            printContent += `
                    <div class="footer">
                        Hotel Sheraton Chihuahua Soberano<br>
                        Sistema de Auditoría de Sistemas<br>
                        Generado el ${new Date().toLocaleString('es-MX')}
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        function exportFailureReportCSV() {
            const failureType = document.getElementById('failureTypeSelect').value;
            if (!failureType) return;
            
            const failedRooms = getFailedRoomsByType(failureType);
            const typeInfo = FAILURE_TYPES[failureType];
            
            let csv = 'Habitacion,Piso,Tipo_Falla,Fecha_Reporte\n';
            
            failedRooms.forEach(room => {
                const floor = Math.floor(parseInt(room) / 100);
                csv += `${room},${floor},"${typeInfo.name}",${new Date().toLocaleDateString('es-MX')}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `reporte_fallas_${failureType}_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('Archivo CSV descargado', 'success');
        }

        function updateAllFailuresSummary() {
            const container = document.getElementById('allFailuresSummary');
            const rooms = Object.keys(auditData);
            
            if (rooms.length === 0) {
                container.innerHTML = `
                    <p style="color: var(--text-muted); text-align: center; padding: 20px; grid-column: 1 / -1;">
                        Completa auditorías para ver el resumen de fallas
                    </p>
                `;
                return;
            }
            
            let html = '';
            
            Object.keys(FAILURE_TYPES).forEach(key => {
                const failedRooms = getFailedRoomsByType(key);
                const info = FAILURE_TYPES[key];
                const hasFailures = failedRooms.length > 0;
                
                html += `
                    <div class="failure-summary-card ${hasFailures ? '' : 'no-failures'}" 
                         onclick="document.getElementById('failureTypeSelect').value='${key}'; generateFailureReport(); document.getElementById('failureTypeSelect').scrollIntoView({behavior:'smooth'});">
                        <span class="failure-summary-icon">${info.icon}</span>
                        <div class="failure-summary-info">
                            <div class="failure-summary-name">${info.name}</div>
                            <div class="failure-summary-count">${failedRooms.length}</div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Actualizar contadores de pisos
            updateFloorIssueCounts();
        }

        // ============================================
        // REPORTES POR PISO
        // ============================================
        
        let currentFloorReport = null;
        
        function updateFloorIssueCounts() {
            for (let floor = 1; floor <= 5; floor++) {
                const floorData = getFloorReportData(floor);
                const issueCount = floorData.roomsWithIssues.length;
                const countElement = document.getElementById(`floor-${floor}-issues`);
                if (countElement) {
                    countElement.textContent = `${issueCount} incidencia${issueCount !== 1 ? 's' : ''}`;
                    if (issueCount > 0) {
                        countElement.classList.add('has-issues');
                    } else {
                        countElement.classList.remove('has-issues');
                    }
                }
            }
        }
        
        function getFloorReportData(floor) {
            const floorRooms = ROOMS_BY_FLOOR[floor] || [];
            const auditedRooms = [];
            const pendingRooms = [];
            const roomsWithIssues = [];
            const roomsOk = [];
            
            floorRooms.forEach(roomNum => {
                const room = roomNum.toString();
                if (auditData[room]) {
                    auditedRooms.push(room);
                    const issues = getRoomIssues(room);
                    if (issues.length > 0) {
                        roomsWithIssues.push({ room, issues, data: auditData[room] });
                    } else {
                        roomsOk.push(room);
                    }
                } else {
                    pendingRooms.push(room);
                }
            });
            
            return {
                floor,
                total: floorRooms.length,
                audited: auditedRooms.length,
                pending: pendingRooms.length,
                roomsWithIssues,
                roomsOk,
                auditedRooms,
                pendingRooms
            };
        }
        
        function getRoomIssues(room) {
            const data = auditData[room];
            if (!data) return [];
            
            const issues = [];
            
            // TV Principal
            if (data.screen?.['screen-power'] === 'fail') {
                issues.push({ icon: '📺', category: 'TV Principal', text: 'No enciende' });
            }
            if (data.screen?.['screen-remote'] === 'fail') {
                issues.push({ icon: '📺', category: 'TV Principal', text: 'Control remoto no funciona' });
            }
            if (data.screen?.['screen-image'] === 'fail') {
                issues.push({ icon: '📺', category: 'TV Principal', text: 'Problemas de imagen' });
            }
            if (data.screen?.['tv1-hd'] === 'no') {
                issues.push({ icon: '📺', category: 'TV Principal', text: 'No soporta HD' });
            }
            
            // TV Secundaria
            if (data.screen2?.['screen2-power'] === 'fail') {
                issues.push({ icon: '📺', category: 'TV Secundaria', text: 'No enciende' });
            }
            if (data.screen2?.['screen2-remote'] === 'fail') {
                issues.push({ icon: '📺', category: 'TV Secundaria', text: 'Control remoto no funciona' });
            }
            if (data.screen2?.['screen2-image'] === 'fail') {
                issues.push({ icon: '📺', category: 'TV Secundaria', text: 'Problemas de imagen' });
            }
            if (data.screen2?.supportsHD === 'no') {
                issues.push({ icon: '📺', category: 'TV Secundaria', text: 'No soporta HD' });
            }
            
            // Canales
            if (data.channels?.startup === 'fail') {
                issues.push({ icon: '📡', category: 'Canales', text: 'Canal de inicio con falla' });
            }
            if (data.failedChannels && data.failedChannels.length > 0) {
                issues.push({ icon: '📡', category: 'Canales', text: `${data.failedChannels.length} canal(es) con falla` });
            }
            
            // Teléfono
            if (data.phone?.['phone-desk'] === 'fail') {
                issues.push({ icon: '📞', category: 'Teléfono', text: 'Escritorio - no suena' });
            }
            if (data.phone?.['phone-nightstand'] === 'fail') {
                issues.push({ icon: '📞', category: 'Teléfono', text: 'Buró - no marca' });
            }
            if (data.phone?.['phone-nightstand'] === 'na') {
                issues.push({ icon: '📞', category: 'Teléfono', text: 'Teléfono de buró faltante' });
            }
            if (data.phone?.['phone-battery'] === 'fail') {
                issues.push({ icon: '📞', category: 'Teléfono', text: 'Display apagado' });
            }
            if (data.phone?.['phone-panasonic'] === 'si') {
                issues.push({ icon: '📞', category: 'Teléfono', text: 'Modelo Panasonic (no estándar)' });
            }
            
            // Red/WiFi
            if (data.network?.['network-wall'] === 'fail') {
                issues.push({ icon: '🌐', category: 'Red', text: 'Nodo de pared con falla' });
            }
            if (data.network?.['network-connection'] === 'fail') {
                issues.push({ icon: '🌐', category: 'Red', text: 'Sin conexión de red' });
            }
            if (data.network?.['network-speed'] === 'fail') {
                issues.push({ icon: '🌐', category: 'Red', text: 'Velocidad deficiente' });
            }
            if (data.network?.['wifi-coverage'] === 'baja') {
                issues.push({ icon: '📶', category: 'WiFi', text: 'Cobertura BAJA - Necesita router' });
            }
            if (data.network?.['wifi-coverage'] === 'media') {
                issues.push({ icon: '📶', category: 'WiFi', text: 'Cobertura MEDIA' });
            }
            
            return issues;
        }
        
        function getRoomType(room) {
            const roomNum = parseInt(room);
            if (roomNum === PRESIDENTIAL_ROOM) return { type: 'Presidencial', class: 'presidencial' };
            if (SUITE_ROOMS.includes(roomNum)) return { type: 'Suite', class: 'suite' };
            if (DOUBLE_ROOMS.includes(roomNum)) return { type: 'Doble', class: '' };
            return { type: 'Sencilla', class: '' };
        }
        
        function generateFloorReport(floor) {
            currentFloorReport = floor;
            
            // Marcar botón activo
            document.querySelectorAll('.floor-select-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.floor-select-btn').classList.add('active');
            
            const floorData = getFloorReportData(floor);
            const resultContainer = document.getElementById('floorReportResult');
            const actionsContainer = document.getElementById('floorReportActions');
            
            let html = `
                <div class="floor-report-header">
                    <h4>🏢 Piso ${floor} - Reporte Detallado</h4>
                    <div class="floor-stats-badges">
                        <span class="floor-stat-badge audited">✅ ${floorData.audited} auditadas</span>
                        <span class="floor-stat-badge issues">⚠️ ${floorData.roomsWithIssues.length} con fallas</span>
                        <span class="floor-stat-badge pending">⏳ ${floorData.pending} pendientes</span>
                    </div>
                </div>
            `;
            
            if (floorData.roomsWithIssues.length === 0 && floorData.audited > 0) {
                html += `
                    <div class="floor-no-issues">
                        <div class="icon">✅</div>
                        <h3>¡Excelente!</h3>
                        <p>No hay incidencias en las ${floorData.audited} habitaciones auditadas del Piso ${floor}</p>
                    </div>
                `;
            } else if (floorData.audited === 0) {
                html += `
                    <div class="floor-no-issues" style="color: var(--accent-warning);">
                        <div class="icon">⏳</div>
                        <h3>Sin auditorías</h3>
                        <p>Aún no hay habitaciones auditadas en el Piso ${floor}</p>
                    </div>
                `;
            } else {
                // Mostrar habitaciones con incidencias primero
                floorData.roomsWithIssues.sort((a, b) => parseInt(a.room) - parseInt(b.room)).forEach(item => {
                    const roomType = getRoomType(item.room);
                    html += `
                        <div class="floor-room-section">
                            <div class="floor-room-header">
                                <span class="floor-room-number">Habitación ${item.room}</span>
                                <span class="floor-room-type ${roomType.class}">${roomType.type}</span>
                            </div>
                            <div class="floor-room-issues">
                                ${item.issues.map(issue => `
                                    <div class="floor-issue-item">
                                        <span class="floor-issue-icon">${issue.icon}</span>
                                        <span class="floor-issue-text"><strong>${issue.category}:</strong> ${issue.text}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });
                
                // Mostrar habitaciones OK (colapsadas)
                if (floorData.roomsOk.length > 0) {
                    html += `
                        <div class="floor-room-section" style="background: rgba(16, 185, 129, 0.05);">
                            <div class="floor-room-header">
                                <span class="floor-room-number" style="color: var(--accent-primary);">✅ Habitaciones sin incidencias (${floorData.roomsOk.length})</span>
                            </div>
                            <div class="floor-room-ok">
                                ${floorData.roomsOk.sort((a, b) => parseInt(a) - parseInt(b)).join(', ')}
                            </div>
                        </div>
                    `;
                }
            }
            
            resultContainer.innerHTML = html;
            actionsContainer.style.display = floorData.audited > 0 ? 'flex' : 'none';
        }
        
        function copyFloorReport() {
            if (!currentFloorReport) return;
            
            const floorData = getFloorReportData(currentFloorReport);
            
            let text = `REPORTE DE PISO ${currentFloorReport}\n`;
            text += `Hotel Sheraton Chihuahua Soberano\n`;
            text += `Fecha: ${new Date().toLocaleDateString('es-MX')}\n`;
            text += `${'='.repeat(50)}\n\n`;
            
            text += `RESUMEN:\n`;
            text += `• Total habitaciones: ${floorData.total}\n`;
            text += `• Auditadas: ${floorData.audited}\n`;
            text += `• Con incidencias: ${floorData.roomsWithIssues.length}\n`;
            text += `• Sin incidencias: ${floorData.roomsOk.length}\n`;
            text += `• Pendientes: ${floorData.pending}\n\n`;
            
            if (floorData.roomsWithIssues.length > 0) {
                text += `DETALLE DE INCIDENCIAS:\n`;
                text += `${'-'.repeat(50)}\n`;
                
                floorData.roomsWithIssues.forEach(item => {
                    const roomType = getRoomType(item.room);
                    text += `\nHabitación ${item.room} (${roomType.type}):\n`;
                    item.issues.forEach(issue => {
                        text += `  • ${issue.category}: ${issue.text}\n`;
                    });
                });
            }
            
            if (floorData.roomsOk.length > 0) {
                text += `\nHABITACIONES SIN INCIDENCIAS:\n`;
                text += floorData.roomsOk.join(', ') + '\n';
            }
            
            text += `\n${'='.repeat(50)}\n`;
            text += `Sistema de Auditoría de Sistemas\n`;
            text += `Generado: ${new Date().toLocaleString('es-MX')}\n`;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('Reporte copiado al portapapeles', 'success');
            }).catch(() => {
                showToast('Error al copiar', 'error');
            });
        }
        
        function printFloorReport() {
            if (!currentFloorReport) return;
            
            const floorData = getFloorReportData(currentFloorReport);
            
            let printContent = `
                <html>
                <head>
                    <title>Reporte Piso ${currentFloorReport} - Hotel Sheraton</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
                        h1 { color: #1a365d; border-bottom: 3px solid #3b82f6; padding-bottom: 10px; }
                        .header-info { background: #f0f9ff; padding: 15px; border-radius: 8px; margin: 20px 0; }
                        .stats { display: flex; gap: 20px; flex-wrap: wrap; margin: 20px 0; }
                        .stat { background: #f5f5f5; padding: 10px 20px; border-radius: 5px; text-align: center; }
                        .stat.issues { background: #fef2f2; border-left: 4px solid #ef4444; }
                        .stat.ok { background: #f0fdf4; border-left: 4px solid #22c55e; }
                        .room-section { margin: 15px 0; padding: 15px; border: 1px solid #e5e7eb; border-radius: 8px; }
                        .room-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
                        .room-number { font-size: 1.1rem; font-weight: bold; color: #1e40af; }
                        .room-type { background: #e5e7eb; padding: 2px 10px; border-radius: 10px; font-size: 0.8rem; }
                        .issue { padding: 8px 12px; background: #fef2f2; border-left: 3px solid #ef4444; margin: 5px 0; border-radius: 4px; }
                        .ok-rooms { background: #f0fdf4; padding: 15px; border-radius: 8px; margin-top: 20px; }
                        .footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; font-size: 12px; text-align: center; }
                    </style>
                </head>
                <body>
                    <h1>🏢 Reporte Piso ${currentFloorReport}</h1>
                    <div class="header-info">
                        <strong>Hotel Sheraton Chihuahua Soberano</strong><br>
                        Fecha: ${new Date().toLocaleDateString('es-MX')}
                    </div>
                    
                    <div class="stats">
                        <div class="stat">📊 Total: <strong>${floorData.total}</strong></div>
                        <div class="stat ok">✅ Auditadas: <strong>${floorData.audited}</strong></div>
                        <div class="stat issues">⚠️ Con fallas: <strong>${floorData.roomsWithIssues.length}</strong></div>
                        <div class="stat">⏳ Pendientes: <strong>${floorData.pending}</strong></div>
                    </div>
            `;
            
            if (floorData.roomsWithIssues.length > 0) {
                printContent += `<h2>Detalle de Incidencias</h2>`;
                floorData.roomsWithIssues.forEach(item => {
                    const roomType = getRoomType(item.room);
                    printContent += `
                        <div class="room-section">
                            <div class="room-header">
                                <span class="room-number">Habitación ${item.room}</span>
                                <span class="room-type">${roomType.type}</span>
                            </div>
                            ${item.issues.map(issue => `
                                <div class="issue">${issue.icon} <strong>${issue.category}:</strong> ${issue.text}</div>
                            `).join('')}
                        </div>
                    `;
                });
            }
            
            if (floorData.roomsOk.length > 0) {
                printContent += `
                    <div class="ok-rooms">
                        <strong>✅ Habitaciones sin incidencias (${floorData.roomsOk.length}):</strong><br>
                        ${floorData.roomsOk.join(', ')}
                    </div>
                `;
            }
            
            printContent += `
                    <div class="footer">
                        Sistema de Auditoría de Sistemas<br>
                        Generado: ${new Date().toLocaleString('es-MX')}
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }
        
        function exportFloorReportCSV() {
            if (!currentFloorReport) return;
            
            const floorData = getFloorReportData(currentFloorReport);
            
            let csv = 'Piso,Habitacion,Tipo,Estado,Categoria_Falla,Detalle_Falla\n';
            
            // Habitaciones con incidencias
            floorData.roomsWithIssues.forEach(item => {
                const roomType = getRoomType(item.room);
                item.issues.forEach(issue => {
                    csv += `${currentFloorReport},${item.room},"${roomType.type}","Con Falla","${issue.category}","${issue.text}"\n`;
                });
            });
            
            // Habitaciones OK
            floorData.roomsOk.forEach(room => {
                const roomType = getRoomType(room);
                csv += `${currentFloorReport},${room},"${roomType.type}","OK","",""\n`;
            });
            
            // Habitaciones pendientes
            floorData.pendingRooms.forEach(room => {
                const roomType = getRoomType(room);
                csv += `${currentFloorReport},${room},"${roomType.type}","Pendiente","",""\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `reporte_piso_${currentFloorReport}_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('Archivo CSV descargado', 'success');
        }

        function exportToCSV() {
            const rooms = Object.keys(auditData);
            if (rooms.length === 0) { showToast('No hay datos para exportar', 'warning'); return; }
            
            let csv = 'Habitacion,Tipo,Auditor,Turno,Fecha,TV1_Pulgadas,TV1_SoportaHD,TV1_Enciende,TV1_Control,TV1_Imagen,TV2_Pulgadas,TV2_SoportaHD,TV2_Enciende,TV2_Control,TV2_Imagen,CanalInicio,CanalesFallidos,TelEscritorio,TelBuro,BateriaAuriculares,CondicionTel,TelPanasonic,NodoPared,ConexionRed,VelocidadRed,CoberturaWiFi,TotalIncidencias,Notas\n';
            
            rooms.sort((a,b) => parseInt(a) - parseInt(b)).forEach(room => {
                const d = auditData[room];
                csv += [
                    room, 
                    d.roomType, 
                    d.auditor, 
                    d.shift, 
                    d.fecha || '',
                    d.screen?.['tv1-inches'] || '',
                    d.screen?.['tv1-hd'] || '',
                    d.screen?.['screen-power'], 
                    d.screen?.['screen-remote'], 
                    d.screen?.['screen-image'],
                    d.screen2?.inches || 'N/A',
                    d.screen2?.supportsHD || 'N/A',
                    d.screen2?.['screen2-power'] || 'N/A',
                    d.screen2?.['screen2-remote'] || 'N/A',
                    d.screen2?.['screen2-image'] || 'N/A',
                    d.channels?.startup, 
                    (d.failedChannels||[]).join(';'), 
                    d.phone?.['phone-desk'], 
                    d.phone?.['phone-nightstand'], 
                    d.phone?.['phone-battery'], 
                    d.phone?.['phone-condition'],
                    d.phone?.['phone-panasonic'] || '',
                    d.network?.['network-wall'], 
                    d.network?.['network-connection'], 
                    d.network?.['network-speed'],
                    d.network?.['wifi-coverage'] || 'N/A',
                    d.issueCount, 
                    (d.notes||'').replace(/,/g,';')
                ].map(v => `"${v||''}"`).join(',') + '\n';
            });
            
            csv += `\n"ROUTERS","${routerTotalCount}","de 42"\n`;
            
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `auditoria_sheraton_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            showToast('CSV exportado correctamente', 'success');
        }

        async function clearAllData() {
            // Verificar permiso
            if (!hasPermission('canClearAll')) {
                showToast('No tienes permiso para realizar esta acción', 'error');
                return;
            }
            
            if (!confirm('¿Eliminar TODOS los datos? Esta acción no se puede deshacer.')) return;
            
            try {
                const response = await fetch(`${API_URL}?action=clearAll`);
                const result = await response.json();
                
                if (result.success) {
                    auditData = {};
                    routerTotalCount = 0;
                    clearRoomState();
                    updateSummary();
                    updateProgress();
                    updateFloorPendingCounts();
                    updateRouterDisplay();
                    generateRoomGrid(currentFloor);
                    showToast('Todos los datos han sido eliminados', 'success');
                } else {
                    showToast('Error al eliminar datos', 'error');
                }
            } catch (error) {
                showToast('Error al eliminar datos: ' + error.message, 'error');
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 's') { e.preventDefault(); saveRoom(); }
            if (e.ctrlKey && e.key === 'ArrowRight') { e.preventDefault(); nextRoom(); }
            if (e.ctrlKey && e.key === 'ArrowLeft') { e.preventDefault(); previousRoom(); }
            if (e.key === 'Escape') { closeRoomReport(); closeMultiSelect(); }
        });

        // ============================================
        // REPORTE DE HABITACIÓN
        // ============================================

        function printRoomReport() {
            const roomNum = document.getElementById('roomNumber').value;
            if (!roomNum) {
                showToast('Selecciona una habitación primero', 'warning');
                return;
            }

            const data = auditData[roomNum];
            const roomType = getRoomType(roomNum);
            const roomTypeLabel = getRoomTypeLabel(roomType);
            const now = new Date();

            // Función helper para obtener estado
            const getStatusLabel = (status) => {
                if (status === 'ok') return '<span class="report-check-status ok">✓ OK</span>';
                if (status === 'fail') return '<span class="report-check-status fail">✗ FALLA</span>';
                if (status === 'na') return '<span class="report-check-status na">N/A</span>';
                return '<span class="report-check-status pending">Pendiente</span>';
            };

            const getSectionStatus = (checks) => {
                const values = Object.values(checks).filter(v => v);
                if (values.length === 0) return '<span class="report-section-status pending">Pendiente</span>';
                const hasFail = values.some(v => v === 'fail');
                if (hasFail) return '<span class="report-section-status fail">Con Fallas</span>';
                return '<span class="report-section-status ok">OK</span>';
            };

            // Contar estadísticas
            let totalChecks = 0, okChecks = 0, failChecks = 0;
            
            if (data) {
                // Screen
                Object.values(data.screen || {}).forEach(v => {
                    if (v) { totalChecks++; if (v === 'ok') okChecks++; if (v === 'fail') failChecks++; }
                });
                // Phone
                Object.values(data.phone || {}).forEach(v => {
                    if (v && v !== 'na') { totalChecks++; if (v === 'ok') okChecks++; if (v === 'fail') failChecks++; }
                });
                // Network
                Object.values(data.network || {}).forEach(v => {
                    if (v && v !== 'na') { totalChecks++; if (v === 'ok') okChecks++; if (v === 'fail') failChecks++; }
                });
                // Channels
                if (data.channels?.startup) {
                    totalChecks++;
                    if (data.channels.startup === 'ok') okChecks++;
                    if (data.channels.startup === 'fail') failChecks++;
                }
                failChecks += (data.failedChannels || []).length;
            }

            // Generar canales
            let channelsHTML = '';
            for (let i = CHANNELS_START; i <= CHANNELS_END; i++) {
                let status = 'pending';
                if (data) {
                    if ((data.failedChannels || []).includes(i.toString())) {
                        status = 'fail';
                    } else if (data.channels?.startup) {
                        // Si hay datos guardados, asumimos que los no fallidos están OK
                        status = 'ok';
                    }
                }
                channelsHTML += `<div class="report-channel ${status}">${i}</div>`;
            }

            const reportHTML = `
                <div class="report-header">
                    <h1>🏨 Hotel Sheraton Chihuahua Soberano</h1>
                    <p>Reporte de Auditoría de Sistemas</p>
                    <div class="report-room-badge">${roomNum}</div>
                    <div class="report-room-type ${roomType}">${roomTypeLabel}</div>
                    <div class="report-meta">
                        <div class="report-meta-item">📅 ${now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                        <div class="report-meta-item">🕐 ${now.toLocaleTimeString('es-MX', { hour: '2-digit', minute: '2-digit' })}</div>
                    </div>
                    ${data ? `
                    <div class="report-meta" style="margin-top: 8px;">
                        <div class="report-meta-item">👤 Auditor: <strong>${data.auditor || 'No especificado'}</strong></div>
                        <div class="report-meta-item">🔄 Turno: <strong>${data.shift || 'No especificado'}</strong></div>
                    </div>
                    ` : ''}
                </div>

                <div class="report-body">
                    ${!data ? `
                        <div style="text-align: center; padding: 40px; color: #64748b;">
                            <p style="font-size: 3rem; margin-bottom: 16px;">📋</p>
                            <h3>Habitación sin auditar</h3>
                            <p>Esta habitación aún no ha sido auditada.</p>
                        </div>
                    ` : `
                        <!-- Pantalla -->
                        <div class="report-section">
                            <div class="report-section-header">
                                <span class="icon">📺</span>
                                <span>1. Pantalla</span>
                                ${getSectionStatus(data.screen || {})}
                            </div>
                            <div class="report-checks">
                                <div class="report-check-item">
                                    <span class="report-check-label">Pantalla enciende correctamente</span>
                                    ${getStatusLabel(data.screen?.['screen-power'])}
                                </div>
                                <div class="report-check-item">
                                    <span class="report-check-label">Control remoto funcional</span>
                                    ${getStatusLabel(data.screen?.['screen-remote'])}
                                </div>
                                <div class="report-check-item">
                                    <span class="report-check-label">Calidad de imagen</span>
                                    ${getStatusLabel(data.screen?.['screen-image'])}
                                </div>
                            </div>
                        </div>

                        <!-- Canales -->
                        <div class="report-section">
                            <div class="report-section-header">
                                <span class="icon">📡</span>
                                <span>2. Canales de TV</span>
                                ${(data.failedChannels || []).length > 0 ? 
                                    '<span class="report-section-status fail">' + (data.failedChannels || []).length + ' fallas</span>' : 
                                    '<span class="report-section-status ok">OK</span>'}
                            </div>
                            <div class="report-checks">
                                <div class="report-check-item">
                                    <span class="report-check-label">Inicia en canal #62 al encender</span>
                                    ${getStatusLabel(data.channels?.startup)}
                                </div>
                            </div>
                            <div style="padding: 0 16px 8px; font-size: 0.8rem; color: #64748b;">
                                Canales verificados (${CHANNELS_START} - ${CHANNELS_END}):
                            </div>
                            <div class="report-channels-grid">
                                ${channelsHTML}
                            </div>
                            ${(data.failedChannels || []).length > 0 ? `
                                <div style="padding: 12px 16px; background: #fee2e2; color: #991b1b; font-size: 0.85rem;">
                                    <strong>Canales con falla:</strong> ${(data.failedChannels || []).join(', ')}
                                </div>
                            ` : ''}
                        </div>

                        <!-- Telefonía -->
                        <div class="report-section">
                            <div class="report-section-header">
                                <span class="icon">📞</span>
                                <span>3. Telefonía</span>
                                ${getSectionStatus(data.phone || {})}
                            </div>
                            <div class="report-checks">
                                <div class="report-check-item">
                                    <span class="report-check-label">Teléfono de escritorio</span>
                                    ${getStatusLabel(data.phone?.['phone-desk'])}
                                </div>
                                <div class="report-check-item">
                                    <span class="report-check-label">Teléfono de buró</span>
                                    ${getStatusLabel(data.phone?.['phone-nightstand'])}
                                </div>
                                <div class="report-check-item">
                                    <span class="report-check-label">Batería de auriculares</span>
                                    ${getStatusLabel(data.phone?.['phone-battery'])}
                                </div>
                                <div class="report-check-item">
                                    <span class="report-check-label">Condición física del equipo</span>
                                    ${getStatusLabel(data.phone?.['phone-condition'])}
                                </div>
                            </div>
                        </div>

                        <!-- Red -->
                        <div class="report-section">
                            <div class="report-section-header">
                                <span class="icon">🌐</span>
                                <span>4. Nodo de Internet</span>
                                ${getSectionStatus(data.network || {})}
                            </div>
                            <div class="report-checks">
                                <div class="report-check-item">
                                    <span class="report-check-label">Nodo de pared funcional</span>
                                    ${getStatusLabel(data.network?.['network-wall'])}
                                </div>
                                <div class="report-check-item">
                                    <span class="report-check-label">Conexión activa</span>
                                    ${getStatusLabel(data.network?.['network-connection'])}
                                </div>
                                <div class="report-check-item">
                                    <span class="report-check-label">Listo para router</span>
                                    ${getStatusLabel(data.network?.['network-speed'])}
                                </div>
                            </div>
                        </div>

                        ${data.notes ? `
                            <div class="report-notes">
                                <h4>📝 Observaciones</h4>
                                <p>${data.notes}</p>
                            </div>
                        ` : ''}

                        <div class="report-summary">
                            <div class="report-summary-item">
                                <h4>Verificaciones OK</h4>
                                <div class="value green">${okChecks}</div>
                            </div>
                            <div class="report-summary-item">
                                <h4>Fallas Detectadas</h4>
                                <div class="value red">${failChecks}</div>
                            </div>
                            <div class="report-summary-item">
                                <h4>Estado General</h4>
                                <div class="value ${failChecks > 0 ? 'red' : 'green'}">${failChecks > 0 ? 'CON FALLAS' : 'OK'}</div>
                            </div>
                        </div>
                    `}
                </div>

                <div class="report-footer">
                    Sistema de Auditoría de Sistemas - Hotel Sheraton Chihuahua Soberano<br>
                    Departamento de Sistemas | Reporte generado el ${now.toLocaleString('es-MX')}
                </div>

                <div class="report-actions">
                    <button class="btn btn-primary" onclick="window.print()">🖨️ Imprimir</button>
                    <button class="btn" onclick="closeRoomReport()">✕ Cerrar</button>
                </div>
            `;

            document.getElementById('roomReportContent').innerHTML = reportHTML;
            document.getElementById('roomReportModal').classList.add('active');
        }

        function closeRoomReport() {
            document.getElementById('roomReportModal').classList.remove('active');
        }

        // Cerrar modal al hacer clic fuera
        document.getElementById('roomReportModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeRoomReport();
            }
        });

        // ============================================
        // REPORTE DE MÚLTIPLES HABITACIONES
        // ============================================

        let selectedRooms = new Set();

        function openMultiSelect() {
            generateMultiSelectGrid();
            document.getElementById('multiSelectModal').classList.add('active');
        }

        function closeMultiSelect() {
            document.getElementById('multiSelectModal').classList.remove('active');
        }

        function generateMultiSelectGrid() {
            const container = document.getElementById('multiSelectFloors');
            container.innerHTML = '';

            for (let floor = 1; floor <= 5; floor++) {
                const rooms = HOTEL_ROOMS[floor];
                const auditedCount = rooms.filter(r => auditData[r]).length;
                const floorDiv = document.createElement('div');
                floorDiv.className = 'multi-select-floor';
                
                floorDiv.innerHTML = `
                    <div class="multi-select-floor-header">
                        <h3>🏢 Piso ${floor}</h3>
                        <span style="font-size: 0.75rem; color: var(--text-muted); margin-left: 8px;">(${rooms.length} hab. | ${auditedCount} auditadas)</span>
                        <span class="floor-select-all" onclick="selectFloorForReport(${floor})">Seleccionar todo el piso</span>
                    </div>
                    <div class="multi-select-grid" id="multiFloor${floor}"></div>
                `;
                
                container.appendChild(floorDiv);
                
                const grid = document.getElementById(`multiFloor${floor}`);
                rooms.forEach(roomNum => {
                    const isAudited = !!auditData[roomNum];
                    const isSelected = selectedRooms.has(roomNum);
                    
                    const roomBtn = document.createElement('div');
                    roomBtn.className = `multi-select-room ${isAudited ? 'audited' : 'not-audited'} ${isSelected ? 'selected' : ''}`;
                    roomBtn.textContent = roomNum;
                    roomBtn.onclick = () => toggleRoomSelection(roomNum);
                    grid.appendChild(roomBtn);
                });
            }

            updateSelectedCount();
        }

        function toggleRoomSelection(roomNum) {
            if (selectedRooms.has(roomNum)) {
                selectedRooms.delete(roomNum);
            } else {
                selectedRooms.add(roomNum);
            }
            
            // Actualizar UI
            const buttons = document.querySelectorAll('.multi-select-room');
            buttons.forEach(btn => {
                if (parseInt(btn.textContent) === roomNum) {
                    btn.classList.toggle('selected');
                }
            });
            
            updateSelectedCount();
        }

        function selectFloorForReport(floor) {
            const rooms = HOTEL_ROOMS[floor];
            rooms.forEach(roomNum => {
                if (!selectedRooms.has(roomNum)) {
                    selectedRooms.add(roomNum);
                }
            });
            generateMultiSelectGrid();
        }

        function clearRoomSelection() {
            selectedRooms.clear();
            generateMultiSelectGrid();
        }

        function selectAllAudited() {
            Object.keys(auditData).forEach(room => {
                selectedRooms.add(parseInt(room));
            });
            generateMultiSelectGrid();
        }

        function addQuickRooms() {
            const input = document.getElementById('quickRoomInput');
            const roomsText = input.value;
            
            // Parsear números separados por comas, espacios, etc.
            const rooms = roomsText.match(/\d+/g);
            
            if (rooms) {
                rooms.forEach(room => {
                    const roomNum = parseInt(room);
                    if (ALL_ROOMS.includes(roomNum)) {
                        selectedRooms.add(roomNum);
                    }
                });
                generateMultiSelectGrid();
                input.value = '';
                showToast(`${rooms.length} habitación(es) agregada(s)`, 'success');
            } else {
                showToast('Ingresa números de habitación válidos', 'warning');
            }
        }

        function updateSelectedCount() {
            document.getElementById('selectedRoomCount').textContent = selectedRooms.size;
            document.getElementById('generateReportBtn').disabled = selectedRooms.size === 0;
        }

        function generateMultiReport() {
            if (selectedRooms.size === 0) {
                showToast('Selecciona al menos una habitación', 'warning');
                return;
            }

            const sortedRooms = Array.from(selectedRooms).sort((a, b) => a - b);
            const now = new Date();

            // Generar contenido de cada habitación
            let roomsHTML = '';
            let totalOk = 0, totalFail = 0, totalPending = 0;

            sortedRooms.forEach((roomNum, index) => {
                const data = auditData[roomNum];
                const roomType = getRoomType(roomNum);
                const roomTypeLabel = getRoomTypeLabel(roomType);

                // Función helper para obtener estado
                const getStatusLabel = (status) => {
                    if (status === 'ok') return '<span class="report-check-status ok">✓ OK</span>';
                    if (status === 'fail') return '<span class="report-check-status fail">✗ FALLA</span>';
                    if (status === 'na') return '<span class="report-check-status na">N/A</span>';
                    return '<span class="report-check-status pending">Pendiente</span>';
                };

                // Contar estadísticas
                let okChecks = 0, failChecks = 0;
                
                if (data) {
                    Object.values(data.screen || {}).forEach(v => {
                        if (v === 'ok') okChecks++;
                        if (v === 'fail') failChecks++;
                    });
                    Object.values(data.phone || {}).forEach(v => {
                        if (v === 'ok') okChecks++;
                        if (v === 'fail') failChecks++;
                    });
                    Object.values(data.network || {}).forEach(v => {
                        if (v === 'ok') okChecks++;
                        if (v === 'fail') failChecks++;
                    });
                    if (data.channels?.startup === 'ok') okChecks++;
                    if (data.channels?.startup === 'fail') failChecks++;
                    failChecks += (data.failedChannels || []).length;
                    
                    totalOk += okChecks;
                    totalFail += failChecks;
                } else {
                    totalPending++;
                }

                roomsHTML += `
                    <div class="report-section" style="page-break-inside: avoid; ${index > 0 ? 'margin-top: 24px;' : ''}">
                        <div class="report-section-header" style="background: linear-gradient(135deg, #1e3a5f, #2d5a87); color: white;">
                            <span style="font-size: 1.5rem; font-weight: 700; font-family: 'JetBrains Mono', monospace;">${roomNum}</span>
                            <span class="report-room-type ${roomType}" style="margin-left: 12px;">${roomTypeLabel}</span>
                            ${data ? `
                                <span style="margin-left: auto; font-size: 0.8rem; opacity: 0.9;">
                                    👤 ${data.auditor || 'N/A'} | 🔄 ${data.shift || 'N/A'}
                                </span>
                            ` : '<span style="margin-left: auto;" class="report-section-status pending">Sin auditar</span>'}
                        </div>
                        
                        ${data ? `
                            <div class="report-checks" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                                <div style="border-right: 1px solid #e5e7eb; padding-right: 12px;">
                                    <h4 style="font-size: 0.8rem; color: #64748b; margin-bottom: 8px;">📺 Pantalla</h4>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Enciende</span>
                                        ${getStatusLabel(data.screen?.['screen-power'])}
                                    </div>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Control</span>
                                        ${getStatusLabel(data.screen?.['screen-remote'])}
                                    </div>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Imagen</span>
                                        ${getStatusLabel(data.screen?.['screen-image'])}
                                    </div>
                                    
                                    <h4 style="font-size: 0.8rem; color: #64748b; margin: 12px 0 8px;">📡 Canales</h4>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Inicio #62</span>
                                        ${getStatusLabel(data.channels?.startup)}
                                    </div>
                                    ${(data.failedChannels || []).length > 0 ? `
                                        <div style="background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; margin-top: 4px;">
                                            Fallas: ${(data.failedChannels || []).join(', ')}
                                        </div>
                                    ` : '<div style="color: #16a34a; font-size: 0.75rem;">✓ Todos OK</div>'}
                                </div>
                                
                                <div style="padding-left: 12px;">
                                    <h4 style="font-size: 0.8rem; color: #64748b; margin-bottom: 8px;">📞 Telefonía</h4>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Escritorio</span>
                                        ${getStatusLabel(data.phone?.['phone-desk'])}
                                    </div>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Buró</span>
                                        ${getStatusLabel(data.phone?.['phone-nightstand'])}
                                    </div>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Batería</span>
                                        ${getStatusLabel(data.phone?.['phone-battery'])}
                                    </div>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Condición</span>
                                        ${getStatusLabel(data.phone?.['phone-condition'])}
                                    </div>
                                    
                                    <h4 style="font-size: 0.8rem; color: #64748b; margin: 12px 0 8px;">🌐 Red</h4>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Nodo</span>
                                        ${getStatusLabel(data.network?.['network-wall'])}
                                    </div>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Conexión</span>
                                        ${getStatusLabel(data.network?.['network-connection'])}
                                    </div>
                                    <div class="report-check-item" style="padding: 4px 0;">
                                        <span class="report-check-label" style="font-size: 0.8rem;">Router</span>
                                        ${getStatusLabel(data.network?.['network-speed'])}
                                    </div>
                                </div>
                            </div>
                            ${data.notes ? `
                                <div style="background: #fffbeb; border-top: 1px solid #fcd34d; padding: 8px 16px; font-size: 0.8rem;">
                                    <strong style="color: #92400e;">📝 Notas:</strong> <span style="color: #78350f;">${data.notes}</span>
                                </div>
                            ` : ''}
                        ` : `
                            <div style="padding: 20px; text-align: center; color: #64748b;">
                                Esta habitación aún no ha sido auditada
                            </div>
                        `}
                    </div>
                `;
            });

            const reportHTML = `
                <div class="report-header">
                    <h1>🏨 Hotel Sheraton Chihuahua Soberano</h1>
                    <p>Reporte de Auditoría de Sistemas - Múltiples Habitaciones</p>
                    <div class="report-room-badge">${sortedRooms.length} Habitaciones</div>
                    <div class="report-meta">
                        <div class="report-meta-item">📅 ${now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                        <div class="report-meta-item">🕐 ${now.toLocaleTimeString('es-MX', { hour: '2-digit', minute: '2-digit' })}</div>
                    </div>
                    <div style="margin-top: 12px; font-size: 0.85rem; opacity: 0.9;">
                        Habitaciones: <strong>${sortedRooms.join(', ')}</strong>
                    </div>
                </div>

                <div class="report-body">
                    <div class="report-summary" style="margin-bottom: 24px;">
                        <div class="report-summary-item">
                            <h4>Habitaciones</h4>
                            <div class="value">${sortedRooms.length}</div>
                        </div>
                        <div class="report-summary-item">
                            <h4>Verificaciones OK</h4>
                            <div class="value green">${totalOk}</div>
                        </div>
                        <div class="report-summary-item">
                            <h4>Fallas Detectadas</h4>
                            <div class="value red">${totalFail}</div>
                        </div>
                    </div>

                    ${roomsHTML}
                </div>

                <div class="report-footer">
                    Sistema de Auditoría de Sistemas - Hotel Sheraton Chihuahua Soberano<br>
                    Departamento de Sistemas | Reporte generado el ${now.toLocaleString('es-MX')}
                </div>

                <div class="report-actions">
                    <button class="btn btn-primary" onclick="window.print()">🖨️ Imprimir</button>
                    <button class="btn" onclick="closeRoomReport(); closeMultiSelect();">✕ Cerrar</button>
                </div>
            `;

            document.getElementById('roomReportContent').innerHTML = reportHTML;
            document.getElementById('roomReportModal').classList.add('active');
        }

        // Cerrar modal multi-select al hacer clic fuera
        document.getElementById('multiSelectModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeMultiSelect();
            }
        });
        
        // ============================================
        // REGISTRO DE SERVICE WORKER (PWA)
        // ============================================
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker registrado'))
                    .catch(err => console.log('Error al registrar SW:', err));
            });
        }
    </script>
</body>
</html>
